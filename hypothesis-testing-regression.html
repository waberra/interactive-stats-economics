<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regression Hypothesis Testing - Canadian Economics</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #1a252f 0%, #2c3e50 100%);
            color: #333;
            min-height: 100vh;
        }
        
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.2em;
        }
        
        .canada-header {
            background: linear-gradient(135deg, #ff0000, #ff6b6b);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }
        
        .scenario-selector {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #dee2e6;
        }
        
        .scenario-btn {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 12px 18px;
            margin: 6px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .scenario-btn:hover {
            background-color: #495057;
            transform: translateY(-2px);
        }
        
        .scenario-btn.active {
            background-color: #007bff;
        }
        
        .model-section {
            background: linear-gradient(135deg, #e8f5e8, #c8e6c9);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #4caf50;
        }
        
        .regression-equation {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border: 3px solid #007bff;
            text-align: center;
            font-size: 1.3em;
            font-family: monospace;
            color: #007bff;
            font-weight: bold;
        }
        
        .data-display {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .data-box {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #dee2e6;
        }
        
        .data-label {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .data-value {
            font-size: 1.1em;
            color: #007bff;
            font-weight: bold;
        }
        
        .coefficient-table {
            background: white;
            border-radius: 8px;
            margin: 15px 0;
            border: 2px solid #007bff;
            overflow-x: auto;
        }
        
        .coef-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
        }
        
        .coef-table th {
            background: #007bff;
            color: white;
            padding: 10px;
            text-align: center;
            font-weight: bold;
        }
        
        .coef-table td {
            padding: 8px;
            text-align: center;
            border-bottom: 1px solid #dee2e6;
        }
        
        .coef-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .calculation-section {
            background: linear-gradient(135deg, #fff8e1, #ffecb3);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #ffc107;
        }
        
        .input-row {
            display: grid;
            grid-template-columns: 2fr 120px 70px 70px 90px;
            gap: 8px;
            align-items: center;
            margin: 12px 0;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            background: #f8f9fa;
            font-size: 0.9em;
        }
        
        .input-row label {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .input-row input {
            padding: 6px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 13px;
        }
        
        .input-row select {
            padding: 6px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 13px;
        }
        
        .small-button {
            padding: 5px 10px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 0.75em;
            font-weight: bold;
            color: white;
        }
        
        .check-btn {
            background: #17a2b8;
        }
        
        .answer-btn {
            background: #28a745;
        }
        
        .steps-btn {
            background: #6f42c1;
        }
        
        .button {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 25px;
            margin: 8px 4px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
        }
        
        .button:hover {
            background: #218838;
        }
        
        .correct {
            background-color: #d4edda !important;
            border-color: #c3e6cb !important;
        }
        
        .incorrect {
            background-color: #f8d7da !important;
            border-color: #f5c6cb !important;
        }
        
        .step-instructions {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #2196f3;
        }
        
        .tutorial-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border: 1px solid #dee2e6;
            display: none;
        }
        
        .tutorial-step {
            background: white;
            padding: 10px;
            margin: 8px 0;
            border-radius: 5px;
            border-left: 3px solid #007bff;
            font-family: monospace;
            font-size: 0.9em;
        }
        
        .answer-display {
            background: #d4edda;
            padding: 8px;
            border-radius: 5px;
            margin: 5px 0;
            border: 1px solid #c3e6cb;
            font-weight: bold;
            display: none;
            font-size: 0.9em;
        }
        
        .decision-section {
            background: linear-gradient(135deg, #f3e5f5, #e1bee7);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #9c27b0;
        }
        
        .formula-box {
            background: #fff;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #dee2e6;
            margin: 10px 0;
            font-family: monospace;
            text-align: center;
            font-size: 1em;
        }
        
        .comparison-table {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border: 2px solid #6c757d;
        }
        
        .method-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
            font-size: 0.85em;
        }
        
        .method-box {
            text-align: center;
            padding: 8px;
            background: #e9ecef;
            border-radius: 5px;
        }
        
        .f-test-section {
            background: linear-gradient(135deg, #ffe0e6, #ffb3c1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #dc3545;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Regression Hypothesis Testing - Advanced</h1>
        
        <div class="canada-header">
            <h2>üá®üá¶ Canadian Economic Regression Analysis</h2>
            <p><strong>Multiple Regression Models</strong> ‚Ä¢ <strong>Coefficient Testing</strong> ‚Ä¢ <strong>F-Tests</strong> ‚Ä¢ <strong>Model Significance</strong></p>
        </div>
        
        <div class="scenario-selector">
            <div style="font-size: 1.2em; font-weight: bold; color: #2c3e50; margin-bottom: 15px;">
                üìà Choose Economic Regression Model:
            </div>
            <button class="scenario-btn" onclick="chooseScenario('gdp-model')">üìä GDP Prediction Model</button>
            <button class="scenario-btn" onclick="chooseScenario('housing-model')">üè† Housing Price Model</button>
            <button class="scenario-btn" onclick="chooseScenario('spending-model')">üí∞ Consumer Spending Model</button>
            <button class="scenario-btn" onclick="chooseScenario('inflation-model')">üìà Inflation Model</button>
        </div>
        
        <div id="problemArea" style="display: none;">
            <div class="model-section">
                <h3>üìã Economic Regression Model:</h3>
                <div class="step-instructions">
                    <div id="modelDescription"></div>
                </div>
                
                <div class="regression-equation" id="regressionEquation">
                    Click "Generate Model" to see regression equation
                </div>
                
                <div class="coefficient-table">
                    <table class="coef-table">
                        <thead>
                            <tr>
                                <th>Variable</th>
                                <th>Coefficient</th>
                                <th>Std Error</th>
                                <th>t-value</th>
                                <th>Economic Meaning</th>
                            </tr>
                        </thead>
                        <tbody id="coefficientTableBody">
                        </tbody>
                    </table>
                </div>
                
                <div class="data-display">
                    <div class="data-box">
                        <div class="data-label">Model Statistics:</div>
                        <div>Sample Size (n): <span id="sampleSize" class="data-value"></span></div>
                        <div>R¬≤: <span id="rSquared" class="data-value"></span></div>
                        <div>Adjusted R¬≤: <span id="adjRSquared" class="data-value"></span></div>
                        <div>F-statistic: <span id="fStatistic" class="data-value"></span></div>
                    </div>
                    <div class="data-box">
                        <div class="data-label">Test Parameters:</div>
                        <div>Degrees of Freedom (regression): <span id="dfRegression" class="data-value"></span></div>
                        <div>Degrees of Freedom (residual): <span id="dfResidual" class="data-value"></span></div>
                        <div>Significance Level (Œ±): <span id="alphaLevel" class="data-value">0.05</span></div>
                        <div>Number of Variables: <span id="numVariables" class="data-value"></span></div>
                    </div>
                </div>
            </div>
            
            <div class="calculation-section">
                <h3>üìä Step 1: Individual Coefficient Testing (t-tests)</h3>
                <div class="step-instructions">
                    <strong>Test each coefficient:</strong> H‚ÇÄ: Œ≤·µ¢ = 0 vs H‚ÇÅ: Œ≤·µ¢ ‚â† 0
                </div>
                
                <div class="formula-box">
                    t = Œ≤·µ¢ / SE(Œ≤·µ¢)     where df = n - k - 1
                </div>
                
                <div id="coefficientTests">
                    <!-- Individual coefficient tests will be dynamically generated -->
                </div>
            </div>
            
            <div class="f-test-section">
                <h3>üìä Step 2: Overall Model Significance (F-test)</h3>
                <div class="step-instructions">
                    <strong>Test overall model:</strong> H‚ÇÄ: All Œ≤·µ¢ = 0 vs H‚ÇÅ: At least one Œ≤·µ¢ ‚â† 0
                </div>
                
                <div class="formula-box">
                    F = (R¬≤/k) / [(1-R¬≤)/(n-k-1)]     where k = number of predictors
                </div>
                
                <div class="input-row">
                    <label for="fTestStatistic">F-statistic:</label>
                    <input type="number" id="fTestStatistic" step="0.001" placeholder="Calculate F">
                    <button class="small-button check-btn" onclick="checkFStatistic()">Check</button>
                    <button class="small-button answer-btn" onclick="showAnswer('fTestStatistic')">Answer</button>
                    <button class="small-button steps-btn" onclick="showSteps('f-test')">Steps</button>
                </div>
                
                <div class="answer-display" id="fTestStatistic-answer"></div>
                <div class="tutorial-box" id="f-test-tutorial"></div>
                
                <div class="input-row">
                    <label for="fCritical">F-critical value:</label>
                    <input type="number" id="fCritical" step="0.001" placeholder="From F-table">
                    <button class="small-button check-btn" onclick="checkFCritical()">Check</button>
                    <button class="small-button answer-btn" onclick="showAnswer('fCritical')">Answer</button>
                    <button class="small-button steps-btn" onclick="showSteps('f-critical')">Steps</button>
                </div>
                
                <div class="answer-display" id="fCritical-answer"></div>
                <div class="tutorial-box" id="f-critical-tutorial"></div>
                
                <div class="input-row">
                    <label for="modelDecision">Overall Model Decision:</label>
                    <select id="modelDecision">
                        <option value="">Choose...</option>
                        <option value="reject">Reject H‚ÇÄ (Model is significant)</option>
                        <option value="fail">Fail to Reject H‚ÇÄ (Model not significant)</option>
                    </select>
                    <button class="small-button check-btn" onclick="checkModelDecision()">Check</button>
                    <button class="small-button answer-btn" onclick="showAnswer('modelDecision')">Answer</button>
                    <button class="small-button steps-btn" onclick="showSteps('model-decision')">Steps</button>
                </div>
                
                <div class="answer-display" id="modelDecision-answer"></div>
                <div class="tutorial-box" id="model-decision-tutorial"></div>
            </div>
            
            <div class="decision-section">
                <h3>‚öñÔ∏è Step 3: Economic Interpretation</h3>
                <div class="step-instructions">
                    <strong>Interpret results in economic context:</strong><br>
                    ‚Ä¢ Which variables significantly affect the dependent variable?<br>
                    ‚Ä¢ How strong is the overall model fit?<br>
                    ‚Ä¢ What are the policy implications?
                </div>
                
                <div class="comparison-table">
                    <h4 style="color: #2c3e50; margin-top: 0;">üìã Coefficient Significance Summary:</h4>
                    <div id="significanceGrid">
                        <!-- Will be populated dynamically -->
                    </div>
                </div>
                
                <div class="input-row">
                    <label>Model Adequacy:</label>
                    <select id="modelAdequacy">
                        <option value="">Choose...</option>
                        <option value="excellent">Excellent (R¬≤ > 0.8)</option>
                        <option value="good">Good (R¬≤ > 0.6)</option>
                        <option value="moderate">Moderate (R¬≤ > 0.4)</option>
                        <option value="weak">Weak (R¬≤ < 0.4)</option>
                    </select>
                    <button class="small-button check-btn" onclick="checkModelAdequacy()">Check</button>
                    <button class="small-button answer-btn" onclick="showAnswer('modelAdequacy')">Answer</button>
                    <button class="small-button steps-btn" onclick="showSteps('model-adequacy')">Steps</button>
                </div>
                
                <div class="answer-display" id="modelAdequacy-answer"></div>
                <div class="tutorial-box" id="model-adequacy-tutorial"></div>
            </div>
            
            <button class="button" onclick="generateNewModel()">üé≤ Generate New Model</button>
            <button class="button" onclick="checkAllAnswers()">‚úÖ Check All Tests</button>
            <button class="button" onclick="showCompleteAnalysis()">üìñ Complete Analysis</button>
        </div>
    </div>

    <script>
        let currentScenario = '';
        let modelData = {};
        let correctAnswers = {};

        const scenarios = {
            'gdp-model': {
                name: 'Canadian GDP Prediction Model',
                description: 'Bank of Canada economists modeling quarterly GDP growth using key economic indicators.',
                dependent: { name: 'GDP Growth (%)', symbol: 'GDP' },
                independent: [
                    { name: 'Business Investment', symbol: 'INV', meaning: 'investment effect' },
                    { name: 'Net Exports', symbol: 'EXP', meaning: 'trade balance effect' },
                    { name: 'Employment Rate', symbol: 'EMP', meaning: 'labor market effect' }
                ],
                equation: 'GDP = Œ≤‚ÇÄ + Œ≤‚ÇÅ(INV) + Œ≤‚ÇÇ(EXP) + Œ≤‚ÇÉ(EMP) + Œµ',
                context: 'macroeconomic growth'
            },
            'housing-model': {
                name: 'Canadian Housing Price Model',
                description: 'CMHC analyzing factors affecting regional housing prices across Canadian markets.',
                dependent: { name: 'Housing Price ($1000s)', symbol: 'PRICE' },
                independent: [
                    { name: 'Median Income', symbol: 'INC', meaning: 'affordability effect' },
                    { name: 'Interest Rate', symbol: 'RATE', meaning: 'financing cost effect' },
                    { name: 'Population Growth', symbol: 'POP', meaning: 'demand pressure effect' }
                ],
                equation: 'PRICE = Œ≤‚ÇÄ + Œ≤‚ÇÅ(INC) + Œ≤‚ÇÇ(RATE) + Œ≤‚ÇÉ(POP) + Œµ',
                context: 'real estate market'
            },
            'spending-model': {
                name: 'Consumer Spending Model',
                description: 'Statistics Canada modeling household spending patterns using economic and demographic factors.',
                dependent: { name: 'Monthly Spending ($)', symbol: 'SPEND' },
                independent: [
                    { name: 'Household Income', symbol: 'INC', meaning: 'income effect' },
                    { name: 'Consumer Confidence', symbol: 'CONF', meaning: 'sentiment effect' },
                    { name: 'Household Size', symbol: 'SIZE', meaning: 'demographic effect' }
                ],
                equation: 'SPEND = Œ≤‚ÇÄ + Œ≤‚ÇÅ(INC) + Œ≤‚ÇÇ(CONF) + Œ≤‚ÇÉ(SIZE) + Œµ',
                context: 'consumer behavior'
            },
            'inflation-model': {
                name: 'Canadian Inflation Model',
                description: 'Bank of Canada examining drivers of inflation using key economic indicators.',
                dependent: { name: 'Inflation Rate (%)', symbol: 'INF' },
                independent: [
                    { name: 'Oil Price', symbol: 'OIL', meaning: 'energy cost effect' },
                    { name: 'Exchange Rate', symbol: 'FX', meaning: 'import price effect' },
                    { name: 'Unemployment Gap', symbol: 'UGAP', meaning: 'labor market pressure' }
                ],
                equation: 'INF = Œ≤‚ÇÄ + Œ≤‚ÇÅ(OIL) + Œ≤‚ÇÇ(FX) + Œ≤‚ÇÉ(UGAP) + Œµ',
                context: 'monetary policy'
            }
        };

        function chooseScenario(scenario) {
            currentScenario = scenario;
            
            document.querySelectorAll('.scenario-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            event.target.classList.add('active');
            
            generateModelData(scenario);
            document.getElementById('problemArea').style.display = 'block';
            clearAllInputs();
        }

        function generateModelData(scenario) {
            const scenarioData = scenarios[scenario];
            const sampleSize = 50 + Math.floor(Math.random() * 50); // 50-100 observations
            const numPredictors = scenarioData.independent.length;
            
            // Generate realistic regression results
            let rSquared = 0.6 + Math.random() * 0.25; // R¬≤ between 0.6-0.85
            let adjRSquared = rSquared - (numPredictors * (1 - rSquared)) / (sampleSize - numPredictors - 1);
            
            // Generate coefficients and statistics
            let coefficients = [];
            let tValues = [];
            let stdErrors = [];
            
            // Intercept
            coefficients.push(10 + Math.random() * 50);
            stdErrors.push(5 + Math.random() * 10);
            tValues.push(coefficients[0] / stdErrors[0]);
            
            // Predictors
            for (let i = 0; i < numPredictors; i++) {
                let coef = (Math.random() - 0.5) * 10; // Random coefficient
                let se = 0.5 + Math.random() * 2; // Standard error
                let t = coef / se;
                
                coefficients.push(coef);
                stdErrors.push(se);
                tValues.push(t);
            }
            
            // Calculate F-statistic
            const dfRegression = numPredictors;
            const dfResidual = sampleSize - numPredictors - 1;
            const fStatistic = (rSquared / dfRegression) / ((1 - rSquared) / dfResidual);
            
            modelData = {
                scenario: scenarioData.name,
                description: scenarioData.description,
                dependent: scenarioData.dependent,
                independent: scenarioData.independent,
                equation: scenarioData.equation,
                context: scenarioData.context,
                sampleSize: sampleSize,
                numPredictors: numPredictors,
                rSquared: rSquared,
                adjRSquared: adjRSquared,
                fStatistic: fStatistic,
                dfRegression: dfRegression,
                dfResidual: dfResidual,
                coefficients: coefficients,
                stdErrors: stdErrors,
                tValues: tValues,
                alpha: 0.05
            };
            
            calculateCorrectAnswers();
            updateDisplay();
        }

        function calculateCorrectAnswers() {
            const { rSquared, numPredictors, dfRegression, dfResidual, fStatistic, sampleSize } = modelData;
            
            // F-critical value (approximate)
            let fCritical;
            if (dfRegression === 3 && dfResidual >= 60) fCritical = 2.76;
            else if (dfRegression === 3 && dfResidual >= 40) fCritical = 2.84;
            else if (dfRegression === 3 && dfResidual >= 30) fCritical = 2.92;
            else if (dfRegression === 3) fCritical = 3.10;
            else if (dfRegression === 2 && dfResidual >= 60) fCritical = 3.15;
            else if (dfRegression === 2 && dfResidual >= 40) fCritical = 3.23;
            else if (dfRegression === 2 && dfResidual >= 30) fCritical = 3.32;
            else fCritical = 3.55;
            
            // t-critical for individual coefficients
            let tCritical;
            if (dfResidual >= 60) tCritical = 2.00;
            else if (dfResidual >= 40) tCritical = 2.02;
            else if (dfResidual >= 30) tCritical = 2.04;
            else if (dfResidual >= 20) tCritical = 2.09;
            else tCritical = 2.15;
            
            // Model decisions
            const modelDecision = fStatistic > fCritical ? 'reject' : 'fail';
            
            // Individual coefficient decisions
            let coefficientDecisions = [];
            for (let i = 0; i < modelData.tValues.length; i++) {
                coefficientDecisions.push(Math.abs(modelData.tValues[i]) > tCritical ? 'significant' : 'not significant');
            }
            
            // Model adequacy
            let adequacy;
            if (rSquared > 0.8) adequacy = 'excellent';
            else if (rSquared > 0.6) adequacy = 'good';
            else if (rSquared > 0.4) adequacy = 'moderate';
            else adequacy = 'weak';
            
            correctAnswers = {
                fTestStatistic: fStatistic,
                fCritical: fCritical,
                tCritical: tCritical,
                modelDecision: modelDecision,
                coefficientDecisions: coefficientDecisions,
                modelAdequacy: adequacy
            };
        }

        function updateDisplay() {
            document.getElementById('modelDescription').innerHTML = 
                `<strong>${modelData.scenario}</strong><br>${modelData.description}`;
            
            document.getElementById('regressionEquation').textContent = modelData.equation;
            
            document.getElementById('sampleSize').textContent = modelData.sampleSize;
            document.getElementById('rSquared').textContent = modelData.rSquared.toFixed(3);
            document.getElementById('adjRSquared').textContent = modelData.adjRSquared.toFixed(3);
            document.getElementById('fStatistic').textContent = modelData.fStatistic.toFixed(2);
            document.getElementById('dfRegression').textContent = modelData.dfRegression;
            document.getElementById('dfResidual').textContent = modelData.dfResidual;
            document.getElementById('numVariables').textContent = modelData.numPredictors;
            
            updateCoefficientTable();
            generateCoefficientTests();
        }

        function updateCoefficientTable() {
            const tbody = document.getElementById('coefficientTableBody');
            tbody.innerHTML = '';
            
            // Intercept row
            const interceptRow = tbody.insertRow();
            interceptRow.innerHTML = `
                <td><strong>Intercept</strong></td>
                <td>${modelData.coefficients[0].toFixed(3)}</td>
                <td>${modelData.stdErrors[0].toFixed(3)}</td>
                <td>${modelData.tValues[0].toFixed(2)}</td>
                <td>Base level when all predictors = 0</td>
            `;
            
            // Predictor rows
            for (let i = 0; i < modelData.independent.length; i++) {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td><strong>${modelData.independent[i].name}</strong></td>
                    <td>${modelData.coefficients[i + 1].toFixed(3)}</td>
                    <td>${modelData.stdErrors[i + 1].toFixed(3)}</td>
                    <td>${modelData.tValues[i + 1].toFixed(2)}</td>
                    <td>${modelData.independent[i].meaning}</td>
                `;
            }
        }

        function generateCoefficientTests() {
            const container = document.getElementById('coefficientTests');
            container.innerHTML = '';
            
            for (let i = 1; i <= modelData.independent.length; i++) {
                const varName = modelData.independent[i - 1].name;
                const testDiv = document.createElement('div');
                testDiv.className = 'input-row';
                testDiv.innerHTML = `
                    <label>${varName} Significance:</label>
                    <select id="coeff${i}Decision">
                        <option value="">Choose...</option>
                        <option value="significant">Significant (Reject H‚ÇÄ)</option>
                        <option value="not significant">Not Significant (Fail to Reject)</option>
                    </select>
                    <button class="small-button check-btn" onclick="checkCoefficient(${i})">Check</button>
                    <button class="small-button answer-btn" onclick="showAnswer('coeff${i}')">Answer</button>
                    <button class="small-button steps-btn" onclick="showSteps('coeff${i}')">Steps</button>
                `;
                container.appendChild(testDiv);
                
                const answerDiv = document.createElement('div');
                answerDiv.className = 'answer-display';
                answerDiv.id = `coeff${i}-answer`;
                container.appendChild(answerDiv);
                
                const tutorialDiv = document.createElement('div');
                tutorialDiv.className = 'tutorial-box';
                tutorialDiv.id = `coeff${i}-tutorial`;
                container.appendChild(tutorialDiv);
            }
        }

        function checkAnswer(inputId, correctValue, tolerance = 0.01) {
            const input = document.getElementById(inputId);
            const userAnswer = parseFloat(input.value);
            
            if (isNaN(userAnswer)) {
                input.className = '';
                return false;
            }
            
            const isCorrect = Math.abs(userAnswer - correctValue) <= tolerance;
            input.className = isCorrect ? 'correct' : 'incorrect';
            return isCorrect;
        }

        function checkFStatistic() {
            return checkAnswer('fTestStatistic', correctAnswers.fTestStatistic, 0.1);
        }

        function checkFCritical() {
            return checkAnswer('fCritical', correctAnswers.fCritical, 0.1);
        }

        function checkModelDecision() {
            const select = document.getElementById('modelDecision');
            const userAnswer = select.value;
            const isCorrect = userAnswer === correctAnswers.modelDecision;
            select.style.backgroundColor = isCorrect ? '#d4edda' : '#f8d7da';
            select.style.borderColor = isCorrect ? '#c3e6cb' : '#f5c6cb';
            return isCorrect;
        }

        function checkModelAdequacy() {
            const select = document.getElementById('modelAdequacy');
            const userAnswer = select.value;
            const isCorrect = userAnswer === correctAnswers.modelAdequacy;
            select.style.backgroundColor = isCorrect ? '#d4edda' : '#f8d7da';
            select.style.borderColor = isCorrect ? '#c3e6cb' : '#f5c6cb';
            return isCorrect;
        }

        function checkCoefficient(index) {
            const select = document.getElementById(`coeff${index}Decision`);
            const userAnswer = select.value;
            const isCorrect = userAnswer === correctAnswers.coefficientDecisions[index];
            select.style.backgroundColor = isCorrect ? '#d4edda' : '#f8d7da';
            select.style.borderColor = isCorrect ? '#c3e6cb' : '#f5c6cb';
            return isCorrect;
        }

        function showAnswer(inputId) {
            const answerDiv = document.getElementById(inputId + '-answer');
            
            if (inputId === 'fTestStatistic') {
                answerDiv.innerHTML = `‚úÖ F-statistic = ${correctAnswers.fTestStatistic.toFixed(2)}`;
            } else if (inputId === 'fCritical') {
                answerDiv.innerHTML = `‚úÖ F-critical = ${correctAnswers.fCritical.toFixed(2)}`;
            } else if (inputId === 'modelDecision') {
                const text = correctAnswers.modelDecision === 'reject' ? 'Reject H‚ÇÄ (Model is significant)' : 'Fail to Reject H‚ÇÄ (Model not significant)';
                answerDiv.innerHTML = `‚úÖ ${text}`;
            } else if (inputId === 'modelAdequacy') {
                answerDiv.innerHTML = `‚úÖ Model adequacy: ${correctAnswers.modelAdequacy.charAt(0).toUpperCase() + correctAnswers.modelAdequacy.slice(1)}`;
            } else if (inputId.startsWith('coeff')) {
                const coeffIndex = parseInt(inputId.replace('coeff', ''));
                const result = correctAnswers.coefficientDecisions[coeffIndex];
                answerDiv.innerHTML = `‚úÖ ${modelData.independent[coeffIndex - 1].name}: ${result}`;
            }
            
            answerDiv.style.display = 'block';
        }

        function showSteps(stepType) {
            const tutorialDiv = document.getElementById(stepType + '-tutorial');
            
            if (stepType === 'f-test') {
                tutorialDiv.innerHTML = `
                    <h4>üìö How to Calculate F-statistic:</h4>
                    <div class="tutorial-step">
                        <strong>Step 1:</strong> Identify components<br>
                        R¬≤ = ${modelData.rSquared.toFixed(3)}<br>
                        k = ${modelData.numPredictors} (number of predictors)<br>
                        n = ${modelData.sampleSize} (sample size)<br><br>
                        <strong>Step 2:</strong> Calculate F-statistic<br>
                        <strong>Formula:</strong> F = (R¬≤/k) / [(1-R¬≤)/(n-k-1)]<br>
                        F = (${modelData.rSquared.toFixed(3)}/${modelData.numPredictors}) / [(1-${modelData.rSquared.toFixed(3)})/(${modelData.sampleSize}-${modelData.numPredictors}-1)]<br>
                        F = ${(modelData.rSquared / modelData.numPredictors).toFixed(4)} / ${((1 - modelData.rSquared) / modelData.dfResidual).toFixed(4)}<br>
                        F = ${correctAnswers.fTestStatistic.toFixed(2)}<br><br>
                        <strong>Interpretation:</strong> Tests if ANY predictors are significantly related to ${modelData.dependent.name}
                    </div>
                `;
            } else if (stepType === 'f-critical') {
                tutorialDiv.innerHTML = `
                    <h4>üìö How to Find F-critical Value:</h4>
                    <div class="tutorial-step">
                        <strong>Parameters:</strong><br>
                        Œ± = ${modelData.alpha}<br>
                        df‚ÇÅ (numerator) = k = ${modelData.dfRegression}<br>
                        df‚ÇÇ (denominator) = n-k-1 = ${modelData.dfResidual}<br><br>
                        <strong>From F-table:</strong><br>
                        F‚ÇÄ.‚ÇÄ‚ÇÖ(${modelData.dfRegression}, ${modelData.dfResidual}) ‚âà ${correctAnswers.fCritical.toFixed(2)}<br><br>
                        <strong>Decision Rule:</strong><br>
                        If F > ${correctAnswers.fCritical.toFixed(2)} ‚Üí Reject H‚ÇÄ (Model is significant)<br>
                        If F ‚â§ ${correctAnswers.fCritical.toFixed(2)} ‚Üí Fail to reject H‚ÇÄ (Model not significant)
                    </div>
                `;
            } else if (stepType === 'model-decision') {
                tutorialDiv.innerHTML = `
                    <h4>üìö Overall Model Decision:</h4>
                    <div class="tutorial-step">
                        <strong>Comparison:</strong><br>
                        F-calculated = ${correctAnswers.fTestStatistic.toFixed(2)}<br>
                        F-critical = ${correctAnswers.fCritical.toFixed(2)}<br><br>
                        <strong>Decision:</strong><br>
                        ${correctAnswers.fTestStatistic.toFixed(2)} ${correctAnswers.fTestStatistic > correctAnswers.fCritical ? '>' : '‚â§'} ${correctAnswers.fCritical.toFixed(2)} ‚Üí ${correctAnswers.modelDecision === 'reject' ? 'Reject H‚ÇÄ' : 'Fail to Reject H‚ÇÄ'}<br><br>
                        <strong>Economic Interpretation:</strong><br>
                        ${correctAnswers.modelDecision === 'reject' ? 
                          `The model explains a significant portion of variation in ${modelData.dependent.name}. At least one predictor has a significant effect.` :
                          `The model does not explain a significant portion of variation in ${modelData.dependent.name}. The predictors may not be useful.`}
                    </div>
                `;
            } else if (stepType.startsWith('coeff')) {
                const coeffIndex = parseInt(stepType.replace('coeff', ''));
                const varName = modelData.independent[coeffIndex - 1].name;
                const tValue = modelData.tValues[coeffIndex];
                const decision = correctAnswers.coefficientDecisions[coeffIndex];
                
                tutorialDiv.innerHTML = `
                    <h4>üìö ${varName} Coefficient Test:</h4>
                    <div class="tutorial-step">
                        <strong>Hypotheses:</strong><br>
                        H‚ÇÄ: Œ≤${coeffIndex} = 0 (no effect of ${varName})<br>
                        H‚ÇÅ: Œ≤${coeffIndex} ‚â† 0 (${varName} has an effect)<br><br>
                        <strong>Test Statistic:</strong><br>
                        t = Œ≤${coeffIndex} / SE(Œ≤${coeffIndex})<br>
                        t = ${modelData.coefficients[coeffIndex].toFixed(3)} / ${modelData.stdErrors[coeffIndex].toFixed(3)}<br>
                        t = ${tValue.toFixed(2)}<br><br>
                        <strong>Decision:</strong><br>
                        |t| = ${Math.abs(tValue).toFixed(2)} ${Math.abs(tValue) > correctAnswers.tCritical ? '>' : '‚â§'} t-critical = ${correctAnswers.tCritical.toFixed(2)}<br>
                        <strong>Conclusion:</strong> ${decision}<br><br>
                        <strong>Economic Meaning:</strong><br>
                        ${decision === 'significant' ? 
                          `${varName} has a statistically significant effect on ${modelData.dependent.name}. The ${modelData.independent[coeffIndex - 1].meaning} is measurable.` :
                          `${varName} does not have a statistically significant effect on ${modelData.dependent.name}. The ${modelData.independent[coeffIndex - 1].meaning} is not detectable.`}
                    </div>
                `;
            } else if (stepType === 'model-adequacy') {
                tutorialDiv.innerHTML = `
                    <h4>üìö Assessing Model Adequacy:</h4>
                    <div class="tutorial-step">
                        <strong>R¬≤ = ${modelData.rSquared.toFixed(3)}</strong><br><br>
                        <strong>Interpretation Guidelines:</strong><br>
                        ‚Ä¢ R¬≤ > 0.8: Excellent explanatory power<br>
                        ‚Ä¢ R¬≤ > 0.6: Good explanatory power<br>
                        ‚Ä¢ R¬≤ > 0.4: Moderate explanatory power<br>
                        ‚Ä¢ R¬≤ < 0.4: Weak explanatory power<br><br>
                        <strong>Your Model:</strong><br>
                        ${(modelData.rSquared * 100).toFixed(1)}% of variation in ${modelData.dependent.name} is explained<br>
                        <strong>Assessment:</strong> ${correctAnswers.modelAdequacy}<br><br>
                        <strong>Adjusted R¬≤:</strong> ${modelData.adjRSquared.toFixed(3)}<br>
                        (Accounts for number of variables in model)
                    </div>
                `;
            }
            
            tutorialDiv.style.display = tutorialDiv.style.display === 'none' ? 'block' : 'none';
        }

        function checkAllAnswers() {
            let results = [];
            results.push(checkFStatistic());
            results.push(checkFCritical());
            results.push(checkModelDecision());
            results.push(checkModelAdequacy());
            
            for (let i = 1; i <= modelData.independent.length; i++) {
                results.push(checkCoefficient(i));
            }
            
            const correct = results.filter(r => r).length;
            const total = results.length;
            
            alert(`You got ${correct}/${total} tests correct!\n\n${correct === total ? 'Excellent regression analysis! All tests complete! üéâ' : 'Review the incorrect tests using the Steps buttons.'}`);
        }

        function generateNewModel() {
            if (currentScenario) {
                generateModelData(currentScenario);
                clearAllInputs();
            } else {
                alert('Please select an economic model first.');
            }
        }

        function clearAllInputs() {
            const inputs = ['fTestStatistic', 'fCritical'];
            inputs.forEach(id => {
                const input = document.getElementById(id);
                if (input) {
                    input.value = '';
                    input.className = '';
                }
            });
            
            const selects = ['modelDecision', 'modelAdequacy'];
            selects.forEach(id => {
                const select = document.getElementById(id);
                if (select) {
                    select.value = '';
                    select.style.backgroundColor = '';
                    select.style.borderColor = '';
                }
            });
            
            // Clear coefficient tests
            for (let i = 1; i <= (modelData.independent ? modelData.independent.length : 3); i++) {
                const select = document.getElementById(`coeff${i}Decision`);
                if (select) {
                    select.value = '';
                    select.style.backgroundColor = '';
                    select.style.borderColor = '';
                }
            }
        }

        function showCompleteAnalysis() {
            if (!currentScenario) {
                alert('Please select an economic model first.');
                return;
            }
            
            const significantVars = [];
            for (let i = 1; i <= modelData.independent.length; i++) {
                if (correctAnswers.coefficientDecisions[i] === 'significant') {
                    significantVars.push(modelData.independent[i - 1].name);
                }
            }
            
            alert(`Complete Regression Analysis:\n\nModel: ${modelData.scenario}\nEquation: ${modelData.equation}\n\nModel Statistics:\n‚Ä¢ R¬≤ = ${modelData.rSquared.toFixed(3)} (${(modelData.rSquared * 100).toFixed(1)}% explained)\n‚Ä¢ F = ${correctAnswers.fTestStatistic.toFixed(2)}\n‚Ä¢ Overall significance: ${correctAnswers.modelDecision === 'reject' ? 'YES' : 'NO'}\n\nSignificant Variables:\n${significantVars.length > 0 ? significantVars.join(', ') : 'None'}\n\nModel Adequacy: ${correctAnswers.modelAdequacy}\n\nEconomic Conclusion: ${correctAnswers.modelDecision === 'reject' ? 'This model provides useful insights for ' + modelData.context + ' analysis.' : 'This model may need additional variables or different specification.'}`);
        }
    </script>
</body>
</html>
