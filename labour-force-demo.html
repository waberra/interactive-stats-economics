<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Labour Force Statistics Calculator - Statistics Canada Method</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #1e4d5b 0%, #2d6a4f 100%);
            color: #333;
            min-height: 100vh;
        }
        
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            background: linear-gradient(135deg, #1e4d5b, #2d6a4f);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .canadian-flag {
            text-align: center;
            font-size: 2em;
            margin-bottom: 20px;
        }
        
        .formula-box {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #1e4d5b;
            text-align: center;
        }
        
        .formula {
            font-size: 1.2em;
            font-weight: bold;
            color: #2c3e50;
            font-family: 'Courier New', monospace;
            margin: 8px 0;
        }
        
        .formula-explanation {
            margin-top: 15px;
            font-size: 0.9em;
            color: #555;
        }
        
        .type-indicator {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
            margin-bottom: 20px;
        }
        
        .type-basic {
            background: linear-gradient(135deg, #2196f3, #1976d2);
            color: white;
        }
        
        .type-analysis {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
        }
        
        .type-comprehensive {
            background: linear-gradient(135deg, #9c27b0, #7b1fa2);
            color: white;
        }
        
        .economic-context {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #dee2e6;
        }
        
        .context-header {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .economic-data {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .data-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .data-label {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .data-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #1e4d5b;
        }
        
        .question-text {
            background: linear-gradient(135deg, #ecf0f1, #bdc3c7);
            padding: 25px;
            border-left: 5px solid #1e4d5b;
            margin-bottom: 25px;
            line-height: 1.6;
            border-radius: 0 10px 10px 0;
        }
        
        .question-text h3 {
            margin-top: 0;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .labour-components {
            background: linear-gradient(135deg, #e8f5e8, #c8e6c9);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #4caf50;
        }
        
        .component-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .component-item {
            background: white;
            padding: 12px;
            border-radius: 6px;
            text-align: center;
            border: 2px solid #4caf50;
        }
        
        .component-label {
            font-weight: bold;
            color: #2c3e50;
            font-size: 0.9em;
        }
        
        .component-value {
            font-size: 1.3em;
            font-weight: bold;
            color: #2e7d32;
            margin-top: 5px;
        }
        
        .answer-section {
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            padding: 25px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            margin: 20px 0;
        }
        
        .input-group {
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .input-group label {
            display: inline-block;
            min-width: 200px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .input-group input {
            width: 150px;
            padding: 10px 15px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            font-size: 16px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #1e4d5b;
            box-shadow: 0 0 0 3px rgba(30, 77, 91, 0.1);
            transform: translateY(-1px);
        }
        
        .input-correct {
            border-color: #4caf50 !important;
            background-color: #e8f5e8 !important;
        }
        
        .input-incorrect {
            border-color: #f44336 !important;
            background-color: #ffebee !important;
        }
        
        .btn {
            background: linear-gradient(135deg, #1e4d5b, #2d6a4f);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn:hover {
            background: linear-gradient(135deg, #2d6a4f, #40916c);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
        }
        
        .btn-secondary:hover {
            background: linear-gradient(135deg, #7f8c8d, #6c7b7d);
        }
        
        .btn-generate {
            background: linear-gradient(135deg, #2196f3, #1976d2);
        }
        
        .btn-generate:hover {
            background: linear-gradient(135deg, #1976d2, #1565c0);
        }
        
        .feedback {
            padding: 18px;
            margin: 20px 0;
            border-radius: 10px;
            font-weight: bold;
            border-left: 5px solid;
        }
        
        .feedback.correct {
            background: linear-gradient(135deg, #e8f5e8, #c8e6c9);
            color: #2e7d32;
            border-left-color: #4caf50;
        }
        
        .feedback.partial {
            background: linear-gradient(135deg, #fff3e0, #ffe0b2);
            color: #ef6c00;
            border-left-color: #ff9800;
        }
        
        .feedback.incorrect {
            background: linear-gradient(135deg, #ffebee, #ffcdd2);
            color: #c62828;
            border-left-color: #f44336;
        }
        
        .solution {
            background: linear-gradient(135deg, #eaf2f8, #d6eaf8);
            padding: 25px;
            margin: 25px 0;
            border-radius: 12px;
            border-left: 5px solid #1e4d5b;
        }
        
        .solution h4 {
            margin-top: 0;
            color: #2c3e50;
            font-size: 1.3em;
        }
        
        .solution-step {
            background-color: white;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border: 1px solid #d6eaf8;
        }
        
        .solution-step h5 {
            margin: 0 0 10px 0;
            color: #2c3e50;
            font-size: 1.1em;
        }
        
        .calculation {
            font-family: 'Courier New', monospace;
            background-color: #f8f9fa;
            padding: 8px 12px;
            border-radius: 5px;
            display: block;
            margin: 5px 0;
            border: 1px solid #dee2e6;
            font-size: 1.1em;
        }
        
        .result {
            font-size: 1.2em;
            font-weight: bold;
            color: #2c3e50;
            background: linear-gradient(135deg, #d6eaf8, #aed6f1);
            padding: 10px 15px;
            border-radius: 5px;
            display: inline-block;
            margin: 8px 0;
        }
        
        .interpretation-box {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
            font-style: italic;
            color: #1565c0;
        }
        
        .hidden {
            display: none;
        }
        
        .navigation {
            text-align: center;
            margin: 30px 0;
        }
        
        .question-counter {
            background: linear-gradient(135deg, #1e4d5b, #2d6a4f);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            display: inline-block;
            margin: 10px;
            font-weight: bold;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .question-types {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .type-selector {
            background: linear-gradient(135deg, #ecf0f1, #bdc3c7);
            border: 2px solid #95a5a6;
            padding: 10px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .type-selector.active {
            background: linear-gradient(135deg, #1e4d5b, #2d6a4f);
            color: white;
            border-color: #2d6a4f;
        }
        
        .type-selector:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .comprehensive-answers {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
    </style>
</head>
<body>
    <div class="canadian-flag">üá®üá¶</div>
    <h1>üë• Labour Force Statistics Calculator</h1>
    <h2 style="text-align: center; color: #2c3e50; margin-top: -20px;">Statistics Canada Method</h2>
    
    <div class="container">
        <div class="formula-box">
            <div class="formula">Labour Force = Employed + Unemployed</div>
            <div class="formula">Unemployment Rate = (Unemployed √∑ Labour Force) √ó 100%</div>
            <div class="formula">Employment Rate = (Employed √∑ Working Age Pop.) √ó 100%</div>
            <div class="formula">Participation Rate = (Labour Force √∑ Working Age Pop.) √ó 100%</div>
            <div class="formula-explanation">
                <strong>Working Age Population:</strong> Ages 15+ (Statistics Canada standard)
            </div>
        </div>
        
        <div class="navigation">
            <div class="question-counter" id="question-counter">Question 1 of ‚àû</div>
            
            <div class="question-types">
                <div class="type-selector active" id="basic-selector" onclick="selectQuestionType('basic')">
                    üìä Basic Calculations
                </div>
                <div class="type-selector" id="analysis-selector" onclick="selectQuestionType('analysis')">
                    üìà Regional Analysis
                </div>
                <div class="type-selector" id="comprehensive-selector" onclick="selectQuestionType('comprehensive')">
                    üéØ Comprehensive Study
                </div>
                <div class="type-selector" id="random-selector" onclick="selectQuestionType('random')">
                    üé≤ Random Mix
                </div>
            </div>
            
            <button class="btn btn-generate" onclick="generateNewQuestion()">Generate New Problem</button>
        </div>
        
        <div id="question-container"></div>
        
        <div class="answer-section">
            <div id="answer-inputs"></div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" onclick="checkAnswers()">‚úì Check Answer</button>
                <button class="btn btn-secondary" onclick="showSolution()">üí° Show Solution</button>
                <button class="btn btn-secondary" onclick="clearAnswers()">üóëÔ∏è Clear</button>
            </div>
        </div>

        <div id="feedback" class="feedback hidden"></div>
        
        <div id="solution" class="solution hidden"></div>
    </div>

    <script>
        class LabourForceSimulator {
            constructor() {
                // Economic scenarios with realistic Canadian labour market data
                this.scenarios = {
                    full_employment: {
                        context: 'near full employment',
                        description: 'low unemployment with high labour force participation',
                        unemploymentRange: [3.5, 5.5], // Unemployment rate %
                        participationRange: [63, 67], // Labour force participation rate %
                        employmentRange: [58, 63] // Employment rate %
                    },
                    normal_conditions: {
                        context: 'normal economic conditions',
                        description: 'typical unemployment and participation rates',
                        unemploymentRange: [5.5, 7.5],
                        participationRange: [60, 64],
                        employmentRange: [55, 59]
                    },
                    economic_downturn: {
                        context: 'economic downturn',
                        description: 'elevated unemployment with reduced participation',
                        unemploymentRange: [7.5, 10.5],
                        participationRange: [57, 61],
                        employmentRange: [51, 55]
                    },
                    youth_focus: {
                        context: 'youth labour market focus',
                        description: 'analysis of 15-24 age group employment patterns',
                        unemploymentRange: [10, 16], // Youth unemployment typically higher
                        participationRange: [55, 65],
                        employmentRange: [47, 55]
                    },
                    resource_region: {
                        context: 'resource-dependent region',
                        description: 'commodity-driven employment with seasonal variation',
                        unemploymentRange: [4, 8],
                        participationRange: [64, 68],
                        employmentRange: [58, 64]
                    }
                };

                // Canadian provinces and demographic groups
                this.provinces = [
                    'Ontario', 'Quebec', 'British Columbia', 'Alberta', 'Manitoba', 
                    'Saskatchewan', 'Nova Scotia', 'New Brunswick', 'Newfoundland and Labrador',
                    'Prince Edward Island', 'Northwest Territories', 'Yukon', 'Nunavut'
                ];

                this.ageGroups = [
                    '15-24 years', '25-54 years', '55+ years', '15+ years (total)', 
                    '25+ years (core)', '15-64 years (prime)'
                ];

                // Time periods
                this.months = ['January', 'February', 'March', 'April', 'May', 'June',
                              'July', 'August', 'September', 'October', 'November', 'December'];
                this.years = ['2020', '2021', '2022', '2023', '2024'];

                this.currentQuestion = null;
                this.currentSolution = null;
                this.questionCount = 1;
                this.questionType = 'basic';
            }

            randomBetween(min, max, decimals = 1) {
                const factor = Math.pow(10, decimals);
                return Math.round((Math.random() * (max - min) + min) * factor) / factor;
            }

            generateLabourForceData(scenario = 'normal_conditions') {
                const scenarioData = this.scenarios[scenario];
                
                // Select random location and time period
                const province = this.provinces[Math.floor(Math.random() * this.provinces.length)];
                const ageGroup = this.ageGroups[Math.floor(Math.random() * this.ageGroups.length)];
                const month = this.months[Math.floor(Math.random() * this.months.length)];
                const year = this.years[Math.floor(Math.random() * this.years.length)];
                
                // Generate working age population (thousands)
                const workingAgePop = this.randomBetween(500, 8000, 0); // Varies by province and age group
                
                // Generate labour force participation rate
                const participationRate = this.randomBetween(
                    scenarioData.participationRange[0], 
                    scenarioData.participationRange[1], 
                    1
                );
                
                // Calculate labour force
                const labourForce = Math.round(workingAgePop * (participationRate / 100));
                
                // Generate unemployment rate
                const unemploymentRate = this.randomBetween(
                    scenarioData.unemploymentRange[0], 
                    scenarioData.unemploymentRange[1], 
                    1
                );
                
                // Calculate employed and unemployed
                const unemployed = Math.round(labourForce * (unemploymentRate / 100));
                const employed = labourForce - unemployed;
                
                // Calculate employment rate
                const employmentRate = Math.round((employed / workingAgePop) * 1000) / 10;
                
                // Calculate not in labour force
                const notInLabourForce = workingAgePop - labourForce;
                
                // Generate comparative data for regional analysis
                const nationalUnemploymentRate = this.randomBetween(5.0, 8.0, 1);
                const nationalParticipationRate = this.randomBetween(62.0, 66.0, 1);
                
                return {
                    scenario: scenario,
                    context: scenarioData.context,
                    description: scenarioData.description,
                    province: province,
                    ageGroup: ageGroup,
                    month: month,
                    year: year,
                    timePeriod: `${month} ${year}`,
                    
                    // Core labour force statistics (thousands)
                    workingAgePop: workingAgePop,
                    labourForce: labourForce,
                    employed: employed,
                    unemployed: unemployed,
                    notInLabourForce: notInLabourForce,
                    
                    // Rates (percentages)
                    unemploymentRate: unemploymentRate,
                    employmentRate: employmentRate,
                    participationRate: participationRate,
                    
                    // Comparative data
                    nationalUnemploymentRate: nationalUnemploymentRate,
                    nationalParticipationRate: nationalParticipationRate,
                    
                    // Calculated differences
                    unemploymentGap: Math.round((unemploymentRate - nationalUnemploymentRate) * 10) / 10,
                    participationGap: Math.round((participationRate - nationalParticipationRate) * 10) / 10
                };
            }

            generateQuestion(type = 'random') {
                const scenarios = Object.keys(this.scenarios);
                const scenario = scenarios[Math.floor(Math.random() * scenarios.length)];
                const data = this.generateLabourForceData(scenario);
                
                if (type === 'basic') {
                    const basicTypes = ['unemployment_rate', 'employment_rate', 'participation_rate', 'labour_force'];
                    const selectedType = basicTypes[Math.floor(Math.random() * basicTypes.length)];
                    return this.generateQuestionByType(selectedType, data);
                } else if (type === 'analysis') {
                    const analysisTypes = ['regional_comparison', 'demographic_analysis', 'trend_analysis'];
                    const selectedType = analysisTypes[Math.floor(Math.random() * analysisTypes.length)];
                    return this.generateQuestionByType(selectedType, data);
                } else if (type === 'comprehensive') {
                    return this.generateComprehensiveQuestion(data);
                } else {
                    // Random question type
                    const types = ['unemployment_rate', 'employment_rate', 'participation_rate', 'labour_force', 'regional_comparison'];
                    const randomType = types[Math.floor(Math.random() * types.length)];
                    return this.generateQuestionByType(randomType, data);
                }
            }

            generateQuestionByType(type, data) {
                switch (type) {
                    case 'unemployment_rate':
                        return {
                            type: 'unemployment_rate',
                            data: data,
                            questionText: `Calculate the unemployment rate for ${data.ageGroup} in ${data.province} for ${data.timePeriod}.`,
                            givenComponents: ['unemployed', 'labourForce'],
                            correctAnswer: data.unemploymentRate,
                            answerUnit: '%'
                        };
                    case 'employment_rate':
                        return {
                            type: 'employment_rate',
                            data: data,
                            questionText: `Calculate the employment rate for ${data.ageGroup} in ${data.province} for ${data.timePeriod}.`,
                            givenComponents: ['employed', 'workingAgePop'],
                            correctAnswer: data.employmentRate,
                            answerUnit: '%'
                        };
                    case 'participation_rate':
                        return {
                            type: 'participation_rate',
                            data: data,
                            questionText: `Calculate the labour force participation rate for ${data.ageGroup} in ${data.province} for ${data.timePeriod}.`,
                            givenComponents: ['labourForce', 'workingAgePop'],
                            correctAnswer: data.participationRate,
                            answerUnit: '%'
                        };
                    case 'labour_force':
                        return {
                            type: 'labour_force',
                            data: data,
                            questionText: `Calculate the total labour force for ${data.ageGroup} in ${data.province} for ${data.timePeriod}.`,
                            givenComponents: ['employed', 'unemployed'],
                            correctAnswer: data.labourForce,
                            answerUnit: 'thousands'
                        };
                    case 'regional_comparison':
                        return {
                            type: 'regional_comparison',
                            data: data,
                            questionText: `Compare ${data.province}'s unemployment rate to the national average. Calculate the unemployment gap for ${data.timePeriod}.`,
                            givenComponents: ['unemploymentRate', 'nationalUnemploymentRate'],
                            correctAnswer: data.unemploymentGap,
                            answerUnit: 'percentage points'
                        };
                    case 'demographic_analysis':
                        return {
                            type: 'demographic_analysis',
                            data: data,
                            questionText: `Analyze the ${data.ageGroup} labour market in ${data.province}. What is the employment-to-population ratio for ${data.timePeriod}?`,
                            givenComponents: ['employed', 'workingAgePop'],
                            correctAnswer: data.employmentRate,
                            answerUnit: '%'
                        };
                    case 'trend_analysis':
                        return {
                            type: 'trend_analysis',
                            data: data,
                            questionText: `Given the labour market conditions in ${data.province}, calculate how many people are not in the labour force for ${data.timePeriod}.`,
                            givenComponents: ['workingAgePop', 'labourForce'],
                            correctAnswer: data.notInLabourForce,
                            answerUnit: 'thousands'
                        };
                }
            }

            generateComprehensiveQuestion(data) {
                return {
                    type: 'comprehensive',
                    data: data,
                    questionText: `Complete labour force analysis for ${data.ageGroup} in ${data.province} during ${data.context} in ${data.timePeriod}.`,
                    givenComponents: ['workingAgePop', 'employed', 'unemployed', 'nationalUnemploymentRate', 'nationalParticipationRate'],
                    answers: {
                        labourForce: data.labourForce,
                        unemploymentRate: data.unemploymentRate,
                        employmentRate: data.employmentRate,
                        participationRate: data.participationRate,
                        unemploymentGap: data.unemploymentGap,
                        notInLabourForce: data.notInLabourForce
                    }
                };
            }

            displayQuestion(questionData) {
                const data = questionData.data;
                let typeClass, typeText, questionHTML;

                // Determine question type styling
                if (questionData.type === 'comprehensive') {
                    typeClass = 'type-comprehensive';
                    typeText = 'üéØ Comprehensive Labour Force Analysis';
                } else if (['regional_comparison', 'demographic_analysis', 'trend_analysis'].includes(questionData.type)) {
                    typeClass = 'type-analysis';
                    typeText = 'üìà Labour Market Analysis';
                } else {
                    typeClass = 'type-basic';
                    typeText = 'üìä Basic Labour Force Calculation';
                }

                // Build question display
                questionHTML = `
                    <div class="type-indicator ${typeClass}">${typeText}</div>
                    
                    <div class="economic-context">
                        <div class="context-header">
                            üá®üá¶ Labour Market Context
                        </div>
                        <div class="economic-data">
                            <div class="data-item">
                                <span class="data-label">Province/Territory:</span>
                                <span class="data-value">${data.province}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Age Group:</span>
                                <span class="data-value">${data.ageGroup}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Time Period:</span>
                                <span class="data-value">${data.timePeriod}</span>
                            </div>
                            <div class="data-item">
                                <span class="data-label">Economic Condition:</span>
                                <span class="data-value">${data.context}</span>
                            </div>
                        </div>
                        <p style="font-style: italic; color: #555; margin-top: 15px;">
                            ${data.description}
                        </p>
                    </div>
                    
                    <div class="question-text">
                        <h3>${questionData.questionText}</h3>
                    </div>
                `;

                // Add given data section
                questionHTML += `<div class="labour-components">
                    <div style="font-weight: bold; color: #2c3e50; margin-bottom: 15px; font-size: 1.1em;">
                        üë• Given Labour Force Data
                    </div>
                    <div class="component-grid">`;

                questionData.givenComponents.forEach(component => {
                    let label, value, unit;
                    switch (component) {
                        case 'workingAgePop':
                            label = 'Working Age Population';
                            value = data.workingAgePop.toLocaleString();
                            unit = 'thousands';
                            break;
                        case 'labourForce':
                            label = 'Labour Force';
                            value = data.labourForce.toLocaleString();
                            unit = 'thousands';
                            break;
                        case 'employed':
                            label = 'Employed';
                            value = data.employed.toLocaleString();
                            unit = 'thousands';
                            break;
                        case 'unemployed':
                            label = 'Unemployed';
                            value = data.unemployed.toLocaleString();
                            unit = 'thousands';
                            break;
                        case 'unemploymentRate':
                            label = `${data.province} Unemployment Rate`;
                            value = data.unemploymentRate;
                            unit = '%';
                            break;
                        case 'nationalUnemploymentRate':
                            label = 'National Unemployment Rate';
                            value = data.nationalUnemploymentRate;
                            unit = '%';
                            break;
                        case 'nationalParticipationRate':
                            label = 'National Participation Rate';
                            value = data.nationalParticipationRate;
                            unit = '%';
                            break;
                    }
                    
                    questionHTML += `
                        <div class="component-item">
                            <div class="component-label">${label}</div>
                            <div class="component-value">${value} ${unit}</div>
                        </div>
                    `;
                });

                questionHTML += `</div></div>`;

                // Set up answer inputs based on question type
                if (questionData.type === 'comprehensive') {
                    questionHTML += `
                        <div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 20px; border-radius: 10px; margin: 15px 0; border-left: 4px solid #1e4d5b;">
                            <div style="font-weight: bold; color: #2c3e50; margin-bottom: 15px; font-size: 1.2em;">
                                üéØ Calculate All Components
                            </div>
                            <p><strong>Part A:</strong> Total labour force</p>
                            <p><strong>Part B:</strong> Unemployment rate</p>
                            <p><strong>Part C:</strong> Employment rate</p>
                            <p><strong>Part D:</strong> Labour force participation rate</p>
                            <p><strong>Part E:</strong> Unemployment gap vs. national average</p>
                            <p><strong>Part F:</strong> People not in labour force</p>
                        </div>
                    `;
                    
                    document.getElementById('answer-inputs').innerHTML = `
                        <div class="comprehensive-answers">
                            <div class="input-group">
                                <label>Part A - Labour Force:</label>
                                <input type="number" id="labour-force-input" step="1" placeholder="0">
                                <span style="font-weight: bold;">thousands</span>
                            </div>
                            <div class="input-group">
                                <label>Part B - Unemployment Rate:</label>
                                <input type="number" id="unemployment-rate-input" step="0.1" placeholder="0.0">
                                <span style="font-weight: bold;">%</span>
                            </div>
                            <div class="input-group">
                                <label>Part C - Employment Rate:</label>
                                <input type="number" id="employment-rate-input" step="0.1" placeholder="0.0">
                                <span style="font-weight: bold;">%</span>
                            </div>
                            <div class="input-group">
                                <label>Part D - Participation Rate:</label>
                                <input type="number" id="participation-rate-input" step="0.1" placeholder="0.0">
                                <span style="font-weight: bold;">%</span>
                            </div>
                            <div class="input-group">
                                <label>Part E - Unemployment Gap:</label>
                                <input type="number" id="unemployment-gap-input" step="0.1" placeholder="0.0">
                                <span style="font-weight: bold;">percentage points</span>
                            </div>
                            <div class="input-group">
                                <label>Part F - Not in Labour Force:</label>
                                <input type="number" id="not-in-lf-input" step="1" placeholder="0">
                                <span style="font-weight: bold;">thousands</span>
                            </div>
                        </div>
                    `;
                } else {
                    // Single answer input
                    const inputStep = questionData.answerUnit === '%' || questionData.answerUnit === 'percentage points' ? '0.1' : '1';
                    const placeholder = questionData.answerUnit === '%' || questionData.answerUnit === 'percentage points' ? '0.0' : '0';
                    
                    document.getElementById('answer-inputs').innerHTML = `
                        <div class="input-group">
                            <label>Answer:</label>
                            <input type="number" id="answer-input" step="${inputStep}" placeholder="${placeholder}">
                            <span style="font-weight: bold;">${questionData.answerUnit}</span>
                        </div>
                    `;
                }

                document.getElementById('question-container').innerHTML = questionHTML;
            }

            checkSingleAnswer(answer, correctData) {
                const tolerance = correctData.answerUnit === '%' || correctData.answerUnit === 'percentage points' ? 0.1 : 1;
                const isCorrect = Math.abs(answer - correctData.correctAnswer) <= tolerance;
                
                return {
                    isCorrect,
                    correctAnswer: correctData.correctAnswer
                };
            }

            checkComprehensiveAnswers(answers, correctData) {
                const tolerance = {
                    thousands: 1,
                    percentage: 0.1
                };
                
                const results = {
                    labourForce: Math.abs(answers.labourForce - correctData.answers.labourForce) <= tolerance.thousands,
                    unemploymentRate: Math.abs(answers.unemploymentRate - correctData.answers.unemploymentRate) <= tolerance.percentage,
                    employmentRate: Math.abs(answers.employmentRate - correctData.answers.employmentRate) <= tolerance.percentage,
                    participationRate: Math.abs(answers.participationRate - correctData.answers.participationRate) <= tolerance.percentage,
                    unemploymentGap: Math.abs(answers.unemploymentGap - correctData.answers.unemploymentGap) <= tolerance.percentage,
                    notInLabourForce: Math.abs(answers.notInLabourForce - correctData.answers.notInLabourForce) <= tolerance.thousands
                };
                
                const correctCount = Object.values(results).filter(x => x).length;
                const allCorrect = correctCount === 6;
                
                return {
                    results,
                    correctCount,
                    allCorrect,
                    correctAnswers: correctData.answers
                };
            }

            showSolution(questionData) {
                const data = questionData.data;
                let solutionHTML = '';
                
                if (questionData.type === 'unemployment_rate') {
                    solutionHTML = `
                        <h4>üìä Unemployment Rate Calculation</h4>
                        
                        <div class="solution-step">
                            <h5>Formula: Unemployment Rate = (Unemployed √∑ Labour Force) √ó 100%</h5>
                            <div class="calculation">Given:</div>
                            <div class="calculation">Unemployed = ${data.unemployed.toLocaleString()} thousand</div>
                            <div class="calculation">Labour Force = ${data.labourForce.toLocaleString()} thousand</div>
                        </div>
                        
                        <div class="solution-step">
                            <h5>Calculation</h5>
                            <div class="calculation">Unemployment Rate = (${data.unemployed.toLocaleString()} √∑ ${data.labourForce.toLocaleString()}) √ó 100%</div>
                            <div class="calculation">Unemployment Rate = ${(data.unemployed / data.labourForce).toFixed(4)} √ó 100%</div>
                            <div class="result">Unemployment Rate = ${data.unemploymentRate}%</div>
                        </div>
                        
                        <div class="interpretation-box">
                            <strong>üìà Analysis:</strong> An unemployment rate of ${data.unemploymentRate}% indicates ${data.unemploymentRate < 5 ? 'very low' : data.unemploymentRate < 7 ? 'moderate' : 'elevated'} unemployment for ${data.ageGroup} in ${data.province}.
                        </div>
                    `;

                } else if (questionData.type === 'employment_rate') {
                    solutionHTML = `
                        <h4>üìä Employment Rate Calculation</h4>
                        
                        <div class="solution-step">
                            <h5>Formula: Employment Rate = (Employed √∑ Working Age Population) √ó 100%</h5>
                            <div class="calculation">Given:</div>
                            <div class="calculation">Employed = ${data.employed.toLocaleString()} thousand</div>
                            <div class="calculation">Working Age Population = ${data.workingAgePop.toLocaleString()} thousand</div>
                        </div>
                        
                        <div class="solution-step">
                            <h5>Calculation</h5>
                            <div class="calculation">Employment Rate = (${data.employed.toLocaleString()} √∑ ${data.workingAgePop.toLocaleString()}) √ó 100%</div>
                            <div class="calculation">Employment Rate = ${(data.employed / data.workingAgePop).toFixed(4)} √ó 100%</div>
                            <div class="result">Employment Rate = ${data.employmentRate}%</div>
                        </div>
                        
                        <div class="interpretation-box">
                            <strong>üìà Analysis:</strong> An employment rate of ${data.employmentRate}% shows ${data.employmentRate > 60 ? 'strong' : data.employmentRate > 55 ? 'moderate' : 'weak'} employment conditions for ${data.ageGroup} in ${data.province}.
                        </div>
                    `;

                } else if (questionData.type === 'comprehensive') {
                    solutionHTML = `
                        <h4>üéØ Comprehensive Labour Force Analysis</h4>
                        
                        <div class="solution-step">
                            <h5>Part A: Labour Force Calculation</h5>
                            <div class="calculation">Labour Force = Employed + Unemployed</div>
                            <div class="calculation">Labour Force = ${data.employed.toLocaleString()} + ${data.unemployed.toLocaleString()}</div>
                            <div class="result">Labour Force = ${data.labourForce.toLocaleString()} thousand</div>
                        </div>
                        
                        <div class="solution-step">
                            <h5>Part B: Unemployment Rate</h5>
                            <div class="calculation">Unemployment Rate = (${data.unemployed.toLocaleString()} √∑ ${data.labourForce.toLocaleString()}) √ó 100%</div>
                            <div class="result">Unemployment Rate = ${data.unemploymentRate}%</div>
                        </div>
                        
                        <div class="solution-step">
                            <h5>Part C: Employment Rate</h5>
                            <div class="calculation">Employment Rate = (${data.employed.toLocaleString()} √∑ ${data.workingAgePop.toLocaleString()}) √ó 100%</div>
                            <div class="result">Employment Rate = ${data.employmentRate}%</div>
                        </div>
                        
                        <div class="solution-step">
                            <h5>Part D: Participation Rate</h5>
                            <div class="calculation">Participation Rate = (${data.labourForce.toLocaleString()} √∑ ${data.workingAgePop.toLocaleString()}) √ó 100%</div>
                            <div class="result">Participation Rate = ${data.participationRate}%</div>
                        </div>
                        
                        <div class="solution-step">
                            <h5>Part E: Unemployment Gap</h5>
                            <div class="calculation">Gap = ${data.province} Rate - National Rate = ${data.unemploymentRate}% - ${data.nationalUnemploymentRate}%</div>
                            <div class="result">Unemployment Gap = ${data.unemploymentGap} percentage points</div>
                        </div>
                        
                        <div class="solution-step">
                            <h5>Part F: Not in Labour Force</h5>
                            <div class="calculation">Not in Labour Force = Working Age Pop. - Labour Force</div>
                            <div class="calculation">Not in Labour Force = ${data.workingAgePop.toLocaleString()} - ${data.labourForce.toLocaleString()}</div>
                            <div class="result">Not in Labour Force = ${data.notInLabourForce.toLocaleString()} thousand</div>
                        </div>
                        
                        <div class="interpretation-box">
                            <strong>üá®üá¶ Labour Market Summary:</strong> ${data.province} shows ${data.unemploymentGap > 0 ? 'above-average' : 'below-average'} unemployment compared to national trends, with ${data.participationRate > 65 ? 'high' : data.participationRate > 60 ? 'moderate' : 'low'} labour force participation for ${data.ageGroup}.
                        </div>
                    `;

                } else {
                    // Other question types
                    solutionHTML = `
                        <h4>üìä ${questionData.type.replace('_', ' ').toUpperCase()} Analysis</h4>
                        
                        <div class="solution-step">
                            <h5>Solution</h5>
                            <div class="calculation">Based on Statistics Canada methodology</div>
                            <div class="result">Answer = ${questionData.correctAnswer} ${questionData.answerUnit}</div>
                        </div>
                        
                        <div class="interpretation-box">
                            <strong>üìà Economic Context:</strong> This result reflects ${data.context} conditions in ${data.province} labour market.
                        </div>
                    `;
                }
                
                document.getElementById('solution').innerHTML = solutionHTML;
                document.getElementById('solution').classList.remove('hidden');
            }
        }

        // Initialize simulator
        const simulator = new LabourForceSimulator();

        function selectQuestionType(type) {
            simulator.questionType = type;
            
            // Update selector appearance
            document.querySelectorAll('.type-selector').forEach(el => el.classList.remove('active'));
            document.getElementById(type + '-selector').classList.add('active');
            
            generateNewQuestion();
        }

        function generateNewQuestion() {
            simulator.currentQuestion = simulator.generateQuestion(simulator.questionType);
            simulator.displayQuestion(simulator.currentQuestion);
            
            // Clear previous answers and feedback
            clearAnswers();
            document.getElementById('feedback').classList.add('hidden');
            document.getElementById('solution').classList.add('hidden');
            
            // Update question counter
            document.getElementById('question-counter').textContent = `Question ${simulator.questionCount} of ‚àû`;
            simulator.questionCount++;
        }

        function checkAnswers() {
            if (!simulator.currentQuestion) {
                alert('Please generate a question first!');
                return;
            }

            const feedback = document.getElementById('feedback');
            
            if (simulator.currentQuestion.type === 'comprehensive') {
                const answers = {
                    labourForce: parseFloat(document.getElementById('labour-force-input').value),
                    unemploymentRate: parseFloat(document.getElementById('unemployment-rate-input').value),
                    employmentRate: parseFloat(document.getElementById('employment-rate-input').value),
                    participationRate: parseFloat(document.getElementById('participation-rate-input').value),
                    unemploymentGap: parseFloat(document.getElementById('unemployment-gap-input').value),
                    notInLabourForce: parseFloat(document.getElementById('not-in-lf-input').value)
                };
                
                if (Object.values(answers).some(isNaN)) {
                    feedback.className = 'feedback incorrect';
                    feedback.innerHTML = '‚ö†Ô∏è Please enter valid numbers for all parts.';
                    feedback.classList.remove('hidden');
                    return;
                }
                
                const result = simulator.checkComprehensiveAnswers(answers, simulator.currentQuestion);
                
                // Update input styling
                document.getElementById('labour-force-input').className = result.results.labourForce ? 'input-correct' : 'input-incorrect';
                document.getElementById('unemployment-rate-input').className = result.results.unemploymentRate ? 'input-correct' : 'input-incorrect';
                document.getElementById('employment-rate-input').className = result.results.employmentRate ? 'input-correct' : 'input-incorrect';
                document.getElementById('participation-rate-input').className = result.results.participationRate ? 'input-correct' : 'input-incorrect';
                document.getElementById('unemployment-gap-input').className = result.results.unemploymentGap ? 'input-correct' : 'input-incorrect';
                document.getElementById('not-in-lf-input').className = result.results.notInLabourForce ? 'input-correct' : 'input-incorrect';
                
                feedback.classList.remove('hidden');
                
                if (result.allCorrect) {
                    feedback.className = 'feedback correct';
                    feedback.innerHTML = 'üéâ Perfect! All labour force calculations are correct!<br>üá®üá¶ You have mastered Statistics Canada methodology!';
                } else if (result.correctCount >= 4) {
                    feedback.className = 'feedback partial';
                    feedback.innerHTML = `‚úÖ ${result.correctCount} out of 6 correct!<br>üí° Review the labour force formulas and calculation steps.`;
                } else {
                    feedback.className = 'feedback incorrect';
                    feedback.innerHTML = `‚ùå Most calculations need adjustment.<br>üë• Remember the key formulas for labour force statistics.`;
                }
            } else {
                const singleInput = parseFloat(document.getElementById('answer-input').value);
                
                if (isNaN(singleInput)) {
                    feedback.className = 'feedback incorrect';
                    feedback.innerHTML = '‚ö†Ô∏è Please enter a valid number.';
                    feedback.classList.remove('hidden');
                    return;
                }
                
                const result = simulator.checkSingleAnswer(singleInput, simulator.currentQuestion);
                
                // Update input styling
                document.getElementById('answer-input').className = result.isCorrect ? 'input-correct' : 'input-incorrect';
                
                feedback.classList.remove('hidden');
                
                if (result.isCorrect) {
                    feedback.className = 'feedback correct';
                    feedback.innerHTML = 'üéâ Excellent! Your labour force calculation is correct!<br>üá®üá¶ Well done with Statistics Canada analysis!';
                } else {
                    feedback.className = 'feedback incorrect';
                    feedback.innerHTML = `‚ùå Not quite right. The correct answer is ${result.correctAnswer} ${simulator.currentQuestion.answerUnit}.<br>üí° Review the labour force formulas and try again.`;
                }
            }
        }

        function showSolution() {
            if (!simulator.currentQuestion) {
                alert('Please generate a question first!');
                return;
            }
            
            simulator.showSolution(simulator.currentQuestion);
        }

        function clearAnswers() {
            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                input.value = '';
                input.className = '';
            });
        }

        // Generate first question on page load
        window.onload = function() {
            generateNewQuestion();
        };
    </script>
</body>
</html>
