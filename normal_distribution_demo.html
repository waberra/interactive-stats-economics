<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Normal Distribution Confidence Intervals - Interactive Demo</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
        }
        
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        
        h1 {
            color: #4a5568;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.2em;
        }
        
        .question-type-indicator {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            display: inline-block;
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 0.9em;
        }
        
        .question-text {
            background: linear-gradient(135deg, #f7fafc, #edf2f7);
            padding: 25px;
            border-left: 5px solid #4299e1;
            margin-bottom: 25px;
            line-height: 1.6;
            border-radius: 0 10px 10px 0;
        }
        
        .question-text h3 {
            margin-top: 0;
            color: #2d3748;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .answer-section {
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            padding: 25px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            margin: 20px 0;
        }
        
        .input-group {
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .input-group label {
            display: inline-block;
            width: 120px;
            font-weight: bold;
            color: #4a5568;
        }
        
        .input-group input {
            width: 160px;
            padding: 10px 15px;
            border: 2px solid #cbd5e0;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.1);
            transform: translateY(-1px);
        }
        
        .btn {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 8px 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn:hover {
            background: linear-gradient(135deg, #3182ce, #2c5282);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #718096, #4a5568);
        }
        
        .btn-secondary:hover {
            background: linear-gradient(135deg, #4a5568, #2d3748);
        }
        
        .btn-generate {
            background: linear-gradient(135deg, #48bb78, #38a169);
        }
        
        .btn-generate:hover {
            background: linear-gradient(135deg, #38a169, #2f855a);
        }
        
        .feedback {
            padding: 18px;
            margin: 20px 0;
            border-radius: 10px;
            font-weight: bold;
            border-left: 5px solid;
        }
        
        .feedback.correct {
            background: linear-gradient(135deg, #f0fff4, #c6f6d5);
            color: #22543d;
            border-left-color: #48bb78;
        }
        
        .feedback.incorrect {
            background: linear-gradient(135deg, #fed7d7, #feb2b2);
            color: #742a2a;
            border-left-color: #f56565;
        }
        
        .solution {
            background: linear-gradient(135deg, #ebf8ff, #bee3f8);
            padding: 25px;
            margin: 25px 0;
            border-radius: 12px;
            border-left: 5px solid #4299e1;
        }
        
        .solution h4 {
            margin-top: 0;
            color: #2c5282;
            font-size: 1.3em;
        }
        
        .solution ul {
            line-height: 1.8;
        }
        
        .hidden {
            display: none;
        }
        
        .stats-highlight {
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            padding: 3px 8px;
            border-radius: 5px;
            font-weight: bold;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .navigation {
            text-align: center;
            margin: 30px 0;
        }
        
        .question-counter {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            display: inline-block;
            margin: 10px;
            font-weight: bold;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .question-types {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .type-selector {
            background: linear-gradient(135deg, #e2e8f0, #cbd5e0);
            border: 2px solid #a0aec0;
            padding: 10px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .type-selector.active {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            border-color: #3182ce;
        }
        
        .type-selector:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .interpretation-box {
            background: linear-gradient(135deg, #fffbeb, #fef5e7);
            border: 2px solid #f6ad55;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <h1>üéØ Normal Distribution Confidence Intervals</h1>
    
    <div class="container">
        <div class="navigation">
            <div class="question-counter" id="question-counter">Question 1 of ‚àû</div>
            
            <div class="question-types">
                <div class="type-selector active" id="mean-selector" onclick="selectQuestionType('mean')">
                    üìä Population Mean (Known œÉ)
                </div>
                <div class="type-selector" id="proportion-selector" onclick="selectQuestionType('proportion')">
                    üìà Population Proportion
                </div>
                <div class="type-selector" id="random-selector" onclick="selectQuestionType('random')">
                    üé≤ Random Mix
                </div>
            </div>
            
            <button class="btn btn-generate" onclick="generateNewQuestion()">Generate New Question</button>
        </div>
        
        <div id="question-container"></div>
        
        <div class="answer-section">
            <div class="input-group">
                <label>Lower limit:</label>
                <input type="number" id="lower-input" step="0.001" placeholder="0.000">
            </div>
            <div class="input-group">
                <label>Upper limit:</label>
                <input type="number" id="upper-input" step="0.001" placeholder="0.000">
            </div>
            <button class="btn" onclick="checkAnswer()">‚úì Check Answer</button>
            <button class="btn btn-secondary" onclick="showSolution()">üí° Show Solution</button>
            <button class="btn btn-secondary" onclick="clearAnswers()">üóëÔ∏è Clear</button>
        </div>

        <div id="feedback" class="feedback hidden"></div>
        
        <div id="solution" class="solution hidden"></div>
    </div>

    <script>
        class NormalDistributionJS {
            constructor() {
                this.zTable = {
                    80: 1.282,
                    90: 1.645,
                    95: 1.960,
                    98: 2.326,
                    99: 2.576
                };
                this.currentQuestion = null;
                this.currentSolution = null;
                this.questionCount = 1;
                this.questionType = 'random'; // 'mean', 'proportion', or 'random'
            }

            generateMeanQuestion() {
                const n = Math.floor(Math.random() * 76) + 25;
                const xbar = Math.round((Math.random() * 40 + 40) * 100) / 100;
                const sigma = Math.round((Math.random() * 9 + 3) * 100) / 100;
                const confidenceLevels = [90, 95, 99];
                const confidence = confidenceLevels[Math.floor(Math.random() * 3)];

                return {n, xbar, sigma, confidence, type: 'mean_known_sigma'};
            }

            generateProportionQuestion() {
                const n = Math.floor(Math.random() * 401) + 100;
                const x = Math.floor(Math.random() * (n - 50)) + 30;
                const p_hat = Math.round((x / n) * 1000) / 1000;
                const confidenceLevels = [90, 95, 99];
                const confidence = confidenceLevels[Math.floor(Math.random() * 3)];

                return {n, x, p_hat, confidence, type: 'proportion'};
            }

            generateQuestion() {
                if (this.questionType === 'mean') {
                    return this.generateMeanQuestion();
                } else if (this.questionType === 'proportion') {
                    return this.generateProportionQuestion();
                } else {
                    return Math.random() < 0.5 ? this.generateMeanQuestion() : this.generateProportionQuestion();
                }
            }

            calculateMeanInterval(n, xbar, sigma, confidence) {
                const zCritical = this.zTable[confidence];
                const se = sigma / Math.sqrt(n);
                const marginError = zCritical * se;
                
                return {
                    se: Math.round(se * 10000) / 10000,
                    zCritical: zCritical,
                    marginError: Math.round(marginError * 10000) / 10000,
                    lowerLimit: Math.round((xbar - marginError) * 1000) / 1000,
                    upperLimit: Math.round((xbar + marginError) * 1000) / 1000
                };
            }

            calculateProportionInterval(n, p_hat, confidence) {
                const zCritical = this.zTable[confidence];
                const se = Math.sqrt((p_hat * (1 - p_hat)) / n);
                const marginError = zCritical * se;
                
                return {
                    se: Math.round(se * 10000) / 10000,
                    zCritical: zCritical,
                    marginError: Math.round(marginError * 10000) / 10000,
                    lowerLimit: Math.round((p_hat - marginError) * 1000) / 1000,
                    upperLimit: Math.round((p_hat + marginError) * 1000) / 1000
                };
            }

            calculateInterval(questionData) {
                if (questionData.type === 'mean_known_sigma') {
                    return this.calculateMeanInterval(
                        questionData.n, questionData.xbar, questionData.sigma, questionData.confidence
                    );
                } else {
                    return this.calculateProportionInterval(
                        questionData.n, questionData.p_hat, questionData.confidence
                    );
                }
            }

            displayQuestion(questionData) {
                const {type, confidence} = questionData;
                let questionContent = '';
                let context = '';
                let typeIndicator = '';

                if (type === 'mean_known_sigma') {
                    const {n, xbar, sigma} = questionData;
                    context = `üìä Population Mean (Known œÉ)`;
                    typeIndicator = `üî¢ Z-Distribution ‚Ä¢ Known Standard Deviation`;
                    questionContent = `
                        <p>A random sample of <span class="stats-highlight">${n}</span> observations was taken from a population with known standard deviation œÉ = <span class="stats-highlight">${sigma}</span>.</p>
                        <p>The sample mean is <span class="stats-highlight">${xbar}</span>.</p>
                    `;
                } else {
                    const {n, x, p_hat} = questionData;
                    context = `üìà Population Proportion`;
                    typeIndicator = `üìä Z-Distribution ‚Ä¢ Large Sample Proportion`;
                    questionContent = `
                        <p>In a random sample of <span class="stats-highlight">${n}</span> individuals, <span class="stats-highlight">${x}</span> had a particular characteristic.</p>
                        <p>This gives a sample proportion of <span class="stats-highlight">${p_hat}</span>.</p>
                    `;
                }

                const target = type === 'mean_known_sigma' ? 'population mean' : 'population proportion';

                const questionHTML = `
                    <div class="question-type-indicator">${typeIndicator}</div>
                    <div class="question-text">
                        <h3>${context}</h3>
                        ${questionContent}
                        <p><strong>Calculate a ${confidence}% confidence interval for the ${target}.</strong></p>
                        <p><em>üìù Give your answers to 3 decimal places.</em></p>
                        <p><em>üéØ Use the standard normal (z) distribution.</em></p>
                    </div>
                `;
                
                document.getElementById('question-container').innerHTML = questionHTML;
            }

            showSolution(questionData, solutionData) {
                const {type, confidence} = questionData;
                const solution = solutionData;
                let solutionHTML = '';

                if (type === 'mean_known_sigma') {
                    const {n, xbar, sigma} = questionData;
                    solutionHTML = `
                        <h4>üìù Step-by-Step Solution (Population Mean)</h4>
                        <p>For a <strong>${confidence}%</strong> confidence interval with known œÉ = <strong>${sigma}</strong>:</p>
                        <ul>
                            <li><strong>Sample size:</strong> n = <span class="stats-highlight">${n}</span></li>
                            <li><strong>Critical z-value:</strong> <span class="stats-highlight">${solution.zCritical}</span></li>
                            <li><strong>Standard error:</strong> œÉ/‚àön = ${sigma}/‚àö${n} = <span class="stats-highlight">${solution.se}</span></li>
                            <li><strong>Margin of error:</strong> ${solution.zCritical} √ó ${solution.se} = <span class="stats-highlight">${solution.marginError}</span></li>
                        </ul>
                        <p><strong>Confidence interval:</strong> ${xbar} ¬± ${solution.marginError}</p>
                        <p><strong>‚úÖ Lower limit:</strong> ${xbar} - ${solution.marginError} = <span class="stats-highlight">${solution.lowerLimit}</span></p>
                        <p><strong>‚úÖ Upper limit:</strong> ${xbar} + ${solution.marginError} = <span class="stats-highlight">${solution.upperLimit}</span></p>
                        
                        <div class="interpretation-box">
                            <strong>üí° Interpretation:</strong> We are ${confidence}% confident that the true population mean lies between ${solution.lowerLimit} and ${solution.upperLimit}.
                        </div>
                    `;
                } else {
                    const {n, x, p_hat} = questionData;
                    const q_hat = Math.round((1 - p_hat) * 1000) / 1000;
                    solutionHTML = `
                        <h4>üìù Step-by-Step Solution (Population Proportion)</h4>
                        <p>For a <strong>${confidence}%</strong> confidence interval for proportion:</p>
                        <ul>
                            <li><strong>Sample size:</strong> n = <span class="stats-highlight">${n}</span></li>
                            <li><strong>Sample proportion:</strong> pÃÇ = ${x}/${n} = <span class="stats-highlight">${p_hat}</span></li>
                            <li><strong>Critical z-value:</strong> <span class="stats-highlight">${solution.zCritical}</span></li>
                            <li><strong>Standard error:</strong> ‚àö[pÃÇ(1-pÃÇ)/n] = ‚àö[${p_hat}√ó${q_hat}/${n}] = <span class="stats-highlight">${solution.se}</span></li>
                            <li><strong>Margin of error:</strong> ${solution.zCritical} √ó ${solution.se} = <span class="stats-highlight">${solution.marginError}</span></li>
                        </ul>
                        <p><strong>Confidence interval:</strong> ${p_hat} ¬± ${solution.marginError}</p>
                        <p><strong>‚úÖ Lower limit:</strong> ${p_hat} - ${solution.marginError} = <span class="stats-highlight">${solution.lowerLimit}</span></p>
                        <p><strong>‚úÖ Upper limit:</strong> ${p_hat} + ${solution.marginError} = <span class="stats-highlight">${solution.upperLimit}</span></p>
                        
                        <div class="interpretation-box">
                            <strong>üí° Interpretation:</strong> We are ${confidence}% confident that the true population proportion lies between ${solution.lowerLimit} and ${solution.upperLimit}.
                        </div>
                    `;
                }
                
                document.getElementById('solution').innerHTML = solutionHTML;
                document.getElementById('solution').classList.remove('hidden');
            }
        }

        // Initialize calculator
        const calculator = new NormalDistributionJS();

        function selectQuestionType(type) {
            calculator.questionType = type;
            
            // Update selector appearance
            document.querySelectorAll('.type-selector').forEach(el => el.classList.remove('active'));
            document.getElementById(type + '-selector').classList.add('active');
            
            generateNewQuestion();
        }

        function generateNewQuestion() {
            calculator.currentQuestion = calculator.generateQuestion();
            calculator.currentSolution = calculator.calculateInterval(calculator.currentQuestion);
            
            calculator.displayQuestion(calculator.currentQuestion);
            
            // Clear previous answers and feedback
            clearAnswers();
            document.getElementById('feedback').classList.add('hidden');
            document.getElementById('solution').classList.add('hidden');
            
            // Update question counter
            document.getElementById('question-counter').textContent = `Question ${calculator.questionCount} of ‚àû`;
            calculator.questionCount++;
        }

        function checkAnswer() {
            if (!calculator.currentSolution) {
                alert('Please generate a question first!');
                return;
            }

            const lowerInput = parseFloat(document.getElementById('lower-input').value);
            const upperInput = parseFloat(document.getElementById('upper-input').value);
            const feedback = document.getElementById('feedback');
            
            if (isNaN(lowerInput) || isNaN(upperInput)) {
                feedback.className = 'feedback incorrect';
                feedback.innerHTML = '‚ö†Ô∏è Please enter valid numbers for both limits.';
                feedback.classList.remove('hidden');
                return;
            }
            
            const tolerance = 0.01;
            const lowerCorrect = Math.abs(lowerInput - calculator.currentSolution.lowerLimit) <= tolerance;
            const upperCorrect = Math.abs(upperInput - calculator.currentSolution.upperLimit) <= tolerance;
            
            feedback.classList.remove('hidden');
            
            if (lowerCorrect && upperCorrect) {
                feedback.className = 'feedback correct';
                feedback.innerHTML = 'üéâ Perfect! Both limits are correct!<br>Your confidence interval calculation is accurate.';
            } else {
                feedback.className = 'feedback incorrect';
                let message = '‚ùå Not quite right. ';
                if (!lowerCorrect && !upperCorrect) {
                    message += 'Both limits need adjustment. ';
                } else if (!lowerCorrect) {
                    message += 'Check your lower limit calculation. ';
                } else {
                    message += 'Check your upper limit calculation. ';
                }
                message += '<br>üí° Review the z-critical value and standard error calculation.';
                feedback.innerHTML = message;
            }
        }

        function showSolution() {
            if (!calculator.currentQuestion || !calculator.currentSolution) {
                alert('Please generate a question first!');
                return;
            }
            
            calculator.showSolution(calculator.currentQuestion, calculator.currentSolution);
        }

        function clearAnswers() {
            document.getElementById('lower-input').value = '';
            document.getElementById('upper-input').value = '';
        }

        // Generate first question on page load
        window.onload = function() {
            generateNewQuestion();
        };
    </script>
</body>
</html>
