<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Equilibrium & Tax Incidence Analysis</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #1a252f 0%, #2c3e50 100%);
            color: #333;
            min-height: 100vh;
        }
        
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            background: linear-gradient(135deg, #1a252f, #2c3e50);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .market-info {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #dee2e6;
        }
        
        .market-type {
            font-size: 1.3em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .market-description {
            color: #555;
            font-style: italic;
            margin-bottom: 15px;
        }
        
        .equations {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .equation {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #3498db;
            text-align: center;
        }
        
        .equation-label {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .equation-value {
            font-size: 1.2em;
            font-family: 'Courier New', monospace;
            color: #3498db;
            font-weight: bold;
        }
        
        .tax-info {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #f39c12;
        }
        
        .tax-rate {
            font-size: 1.2em;
            font-weight: bold;
            color: #e67e22;
            margin-bottom: 8px;
        }
        
        .market-selector {
            background: linear-gradient(135deg, #e8f4f8, #d1ecf1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #3498db;
        }
        
        .market-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .market-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .market-btn:hover {
            background: linear-gradient(135deg, #2980b9, #21618c);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .market-btn.luxury {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
        }
        
        .market-btn.essential {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        
        .market-btn.competitive {
            background: linear-gradient(135deg, #27ae60, #229954);
        }
        
        .questions-section {
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            padding: 25px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            margin: 20px 0;
        }
        
        .question {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        
        .question h4 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .input-group {
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .input-group label {
            display: inline-block;
            min-width: 220px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .input-group input {
            width: 120px;
            padding: 10px 15px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            font-size: 16px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .check-btn {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .check-btn:hover {
            background: linear-gradient(135deg, #229954, #1e8449);
            transform: translateY(-1px);
        }
        
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        
        .result.correct {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .result.incorrect {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .generate-btn {
            background: linear-gradient(135deg, #8e44ad, #7d3c98);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            display: block;
            margin: 30px auto;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .generate-btn:hover {
            background: linear-gradient(135deg, #7d3c98, #6c3483);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .summary-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            text-align: center;
        }
        
        .summary-label {
            font-weight: bold;
            color: #2c3e50;
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .summary-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #3498db;
        }
        
        .interpretation {
            background: linear-gradient(135deg, #e8f4f8, #d1ecf1);
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
            font-style: italic;
            color: #2c3e50;
        }
        
        .hidden {
            display: none;
        }
        
        .good-badge {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            display: inline-block;
            margin: 10px 0;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìà Market Equilibrium & Tax Incidence Analysis</h1>
        <h2 style="text-align: center; color: #2c3e50; margin-top: -20px;">Supply ‚Ä¢ Demand ‚Ä¢ Tax Effects ‚Ä¢ Burden Distribution</h2>
        
        <div class="market-selector">
            <div style="font-weight: bold; color: #2c3e50; margin-bottom: 15px; font-size: 1.2em; text-align: center;">
                üè™ Choose Market Type:
            </div>
            <div class="market-buttons">
                <button class="market-btn luxury" onclick="selectMarket('luxury')">üèÜ Luxury Goods</button>
                <button class="market-btn essential" onclick="selectMarket('essential')">üçû Essential Goods</button>
                <button class="market-btn competitive" onclick="selectMarket('competitive')">‚öñÔ∏è Competitive Market</button>
            </div>
        </div>
        
        <button class="generate-btn" onclick="generateNewMarket()">üé≤ Generate New Market</button>
        
        <div id="market-data" class="hidden">
            <div class="good-badge" id="good-name"></div>
            
            <div class="market-info">
                <div class="market-type" id="market-type-name"></div>
                <div class="market-description" id="market-description"></div>
                
                <div class="equations">
                    <div class="equation">
                        <div class="equation-label">Demand Function</div>
                        <div class="equation-value" id="demand-equation">Qd = a - bP</div>
                    </div>
                    <div class="equation">
                        <div class="equation-label">Supply Function</div>
                        <div class="equation-value" id="supply-equation">Qs = c + dP</div>
                    </div>
                </div>
                
                <div class="tax-info">
                    <h4>üìã Government Policy</h4>
                    <div class="tax-rate" id="tax-amount">Sales Tax: $X per unit</div>
                    <p><em>This tax is imposed on producers, shifting the supply curve upward.</em></p>
                </div>
            </div>
            
            <div class="questions-section">
                <h3>üìù Market Analysis Questions:</h3>
                
                <div class="question">
                    <h4>Original Market Equilibrium (Before Tax)</h4>
                    <div class="input-group">
                        <label>Equilibrium Price ($):</label>
                        <input type="number" id="original-price-input" step="0.01" placeholder="0.00">
                        <button class="check-btn" onclick="checkAnswer('original-price')">Check</button>
                    </div>
                    <div id="original-price-result" class="result"></div>
                    
                    <div class="input-group">
                        <label>Equilibrium Quantity:</label>
                        <input type="number" id="original-quantity-input" step="0.01" placeholder="0.00">
                        <button class="check-btn" onclick="checkAnswer('original-quantity')">Check</button>
                    </div>
                    <div id="original-quantity-result" class="result"></div>
                </div>
                
                <div class="question">
                    <h4>New Market Equilibrium (After Tax)</h4>
                    <div class="input-group">
                        <label>New Equilibrium Price ($):</label>
                        <input type="number" id="new-price-input" step="0.01" placeholder="0.00">
                        <button class="check-btn" onclick="checkAnswer('new-price')">Check</button>
                    </div>
                    <div id="new-price-result" class="result"></div>
                    
                    <div class="input-group">
                        <label>New Equilibrium Quantity:</label>
                        <input type="number" id="new-quantity-input" step="0.01" placeholder="0.00">
                        <button class="check-btn" onclick="checkAnswer('new-quantity')">Check</button>
                    </div>
                    <div id="new-quantity-result" class="result"></div>
                </div>
                
                <div class="question">
                    <h4>Tax Incidence Analysis</h4>
                    <div class="input-group">
                        <label>Consumer Tax Burden ($ per unit):</label>
                        <input type="number" id="consumer-burden-input" step="0.01" placeholder="0.00">
                        <button class="check-btn" onclick="checkAnswer('consumer-burden')">Check</button>
                    </div>
                    <div id="consumer-burden-result" class="result"></div>
                    
                    <div class="input-group">
                        <label>Producer Tax Burden ($ per unit):</label>
                        <input type="number" id="producer-burden-input" step="0.01" placeholder="0.00">
                        <button class="check-btn" onclick="checkAnswer('producer-burden')">Check</button>
                    </div>
                    <div id="producer-burden-result" class="result"></div>
                    
                    <div class="input-group">
                        <label>Total Tax Revenue ($):</label>
                        <input type="number" id="tax-revenue-input" step="0.01" placeholder="0.00">
                        <button class="check-btn" onclick="checkAnswer('tax-revenue')">Check</button>
                    </div>
                    <div id="tax-revenue-result" class="result"></div>
                </div>
            </div>
            
            <div class="summary-grid">
                <div class="summary-item">
                    <div class="summary-label">Market Type</div>
                    <div class="summary-value" id="summary-market-type"></div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Tax Rate</div>
                    <div class="summary-value" id="summary-tax-rate"></div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Demand Elasticity</div>
                    <div class="summary-value" id="summary-demand-elasticity"></div>
                </div>
                <div class="summary-item">
                    <div class="summary-label">Supply Elasticity</div>
                    <div class="summary-value" id="summary-supply-elasticity"></div>
                </div>
            </div>
            
            <div id="economic-interpretation" class="interpretation hidden"></div>
        </div>
    </div>

    <script>
        class TaxIncidenceSimulator {
            constructor() {
                this.marketTypes = {
                    luxury: {
                        name: "Luxury Goods Market",
                        description: "High-end products with elastic demand - consumers are price sensitive",
                        goods: ["Designer Handbags", "Luxury Cars", "Fine Jewelry", "Premium Electronics", "High-End Watches"],
                        demandInterceptRange: [100, 200],
                        demandSlopeRange: [0.8, 1.5], // More elastic (steeper slope in absolute terms)
                        supplySlopeRange: [0.3, 0.7],
                        taxRange: [5, 15]
                    },
                    essential: {
                        name: "Essential Goods Market", 
                        description: "Necessary products with inelastic demand - consumers must buy regardless of price",
                        goods: ["Gasoline", "Medicine", "Basic Food Items", "Utilities", "Housing"],
                        demandInterceptRange: [80, 150],
                        demandSlopeRange: [0.2, 0.6], // Less elastic (flatter slope)
                        supplySlopeRange: [0.4, 0.8],
                        taxRange: [2, 8]
                    },
                    competitive: {
                        name: "Competitive Market",
                        description: "Many producers with elastic supply - producers can easily adjust output",
                        goods: ["Agricultural Products", "Basic Clothing", "Office Supplies", "Fast Food", "Books"],
                        demandInterceptRange: [60, 120],
                        demandSlopeRange: [0.4, 0.8],
                        supplySlopeRange: [0.8, 1.2], // More elastic supply
                        taxRange: [1, 6]
                    }
                };
                
                this.currentMarketType = 'luxury';
                this.currentMarket = null;
            }
            
            randomBetween(min, max, decimals = 2) {
                const factor = Math.pow(10, decimals);
                return Math.round((Math.random() * (max - min) + min) * factor) / factor;
            }
            
            generateMarket(type) {
                const marketData = this.marketTypes[type];
                const good = marketData.goods[Math.floor(Math.random() * marketData.goods.length)];
                
                // Generate demand function: Qd = a - bP
                const demandIntercept = this.randomBetween(marketData.demandInterceptRange[0], marketData.demandInterceptRange[1], 0);
                const demandSlope = this.randomBetween(marketData.demandSlopeRange[0], marketData.demandSlopeRange[1]);
                
                // Generate supply function: Qs = c + dP (ensuring positive intercept)
                const supplyIntercept = this.randomBetween(-20, 20, 0);
                const supplySlope = this.randomBetween(marketData.supplySlopeRange[0], marketData.supplySlopeRange[1]);
                
                // Generate tax rate
                const taxRate = this.randomBetween(marketData.taxRange[0], marketData.taxRange[1]);
                
                // Calculate original equilibrium: Qd = Qs
                // demandIntercept - demandSlope * P = supplyIntercept + supplySlope * P
                // demandIntercept - supplyIntercept = P * (demandSlope + supplySlope)
                const originalPrice = (demandIntercept - supplyIntercept) / (demandSlope + supplySlope);
                const originalQuantity = demandIntercept - demandSlope * originalPrice;
                
                // Calculate new equilibrium with tax (supply curve shifts up by tax amount)
                // New supply: Qs = supplyIntercept + supplySlope * (P - tax)
                // At equilibrium: demandIntercept - demandSlope * P = supplyIntercept + supplySlope * (P - taxRate)
                // demandIntercept - demandSlope * P = supplyIntercept + supplySlope * P - supplySlope * taxRate
                // demandIntercept - supplyIntercept + supplySlope * taxRate = P * (demandSlope + supplySlope)
                const newPrice = (demandIntercept - supplyIntercept + supplySlope * taxRate) / (demandSlope + supplySlope);
                const newQuantity = demandIntercept - demandSlope * newPrice;
                
                // Calculate tax incidence
                const consumerBurden = newPrice - originalPrice;
                const producerBurden = taxRate - consumerBurden;
                const totalTaxRevenue = taxRate * newQuantity;
                
                // Calculate producer price (what they receive after tax)
                const producerPrice = newPrice - taxRate;
                
                return {
                    type: type,
                    name: marketData.name,
                    description: marketData.description,
                    good: good,
                    
                    // Functions
                    demandIntercept: demandIntercept,
                    demandSlope: demandSlope,
                    supplyIntercept: supplyIntercept,
                    supplySlope: supplySlope,
                    taxRate: taxRate,
                    
                    // Original equilibrium
                    originalPrice: Math.round(originalPrice * 100) / 100,
                    originalQuantity: Math.round(originalQuantity * 100) / 100,
                    
                    // New equilibrium
                    newPrice: Math.round(newPrice * 100) / 100,
                    newQuantity: Math.round(newQuantity * 100) / 100,
                    producerPrice: Math.round(producerPrice * 100) / 100,
                    
                    // Tax incidence
                    consumerBurden: Math.round(consumerBurden * 100) / 100,
                    producerBurden: Math.round(producerBurden * 100) / 100,
                    totalTaxRevenue: Math.round(totalTaxRevenue * 100) / 100
                };
            }
            
            displayMarket(market) {
                document.getElementById('good-name').textContent = market.good;
                document.getElementById('market-type-name').textContent = market.name;
                document.getElementById('market-description').textContent = market.description;
                
                document.getElementById('demand-equation').textContent = `Qd = ${market.demandIntercept} - ${market.demandSlope}P`;
                document.getElementById('supply-equation').textContent = `Qs = ${market.supplyIntercept} + ${market.supplySlope}P`;
                document.getElementById('tax-amount').textContent = `Sales Tax: $${market.taxRate} per unit`;
                
                // Summary
                document.getElementById('summary-market-type').textContent = market.type.charAt(0).toUpperCase() + market.type.slice(1);
                document.getElementById('summary-tax-rate').textContent = `$${market.taxRate}`;
                document.getElementById('summary-demand-elasticity').textContent = market.demandSlope > 1 ? 'Elastic' : 'Inelastic';
                document.getElementById('summary-supply-elasticity').textContent = market.supplySlope > 0.7 ? 'Elastic' : 'Inelastic';
                
                // Clear all previous results
                this.clearResults();
                
                document.getElementById('market-data').classList.remove('hidden');
            }
            
            clearResults() {
                const inputs = ['original-price-input', 'original-quantity-input', 'new-price-input', 'new-quantity-input', 
                              'consumer-burden-input', 'producer-burden-input', 'tax-revenue-input'];
                const results = ['original-price-result', 'original-quantity-result', 'new-price-result', 'new-quantity-result',
                               'consumer-burden-result', 'producer-burden-result', 'tax-revenue-result'];
                
                inputs.forEach(id => {
                    document.getElementById(id).value = '';
                });
                
                results.forEach(id => {
                    const element = document.getElementById(id);
                    element.textContent = '';
                    element.className = 'result';
                });
                
                document.getElementById('economic-interpretation').classList.add('hidden');
            }
            
            checkAnswer(type) {
                if (!this.currentMarket) return;
                
                const inputElement = document.getElementById(type + '-input');
                const resultElement = document.getElementById(type + '-result');
                const userAnswer = parseFloat(inputElement.value);
                
                if (isNaN(userAnswer)) {
                    resultElement.textContent = '‚ö†Ô∏è Please enter a valid number';
                    resultElement.className = 'result incorrect';
                    return;
                }
                
                let correctAnswer, tolerance, unit;
                
                switch (type) {
                    case 'original-price':
                        correctAnswer = this.currentMarket.originalPrice;
                        tolerance = 0.05;
                        unit = '';
                        break;
                    case 'original-quantity':
                        correctAnswer = this.currentMarket.originalQuantity;
                        tolerance = 0.1;
                        unit = ' units';
                        break;
                    case 'new-price':
                        correctAnswer = this.currentMarket.newPrice;
                        tolerance = 0.05;
                        unit = '';
                        break;
                    case 'new-quantity':
                        correctAnswer = this.currentMarket.newQuantity;
                        tolerance = 0.1;
                        unit = ' units';
                        break;
                    case 'consumer-burden':
                        correctAnswer = this.currentMarket.consumerBurden;
                        tolerance = 0.05;
                        unit = ' per unit';
                        break;
                    case 'producer-burden':
                        correctAnswer = this.currentMarket.producerBurden;
                        tolerance = 0.05;
                        unit = ' per unit';
                        break;
                    case 'tax-revenue':
                        correctAnswer = this.currentMarket.totalTaxRevenue;
                        tolerance = 0.1;
                        unit = '';
                        break;
                }
                
                const isCorrect = Math.abs(userAnswer - correctAnswer) <= tolerance;
                
                if (isCorrect) {
                    resultElement.textContent = `‚úÖ Correct! The answer is $${correctAnswer.toFixed(2)}${unit}`;
                    resultElement.className = 'result correct';
                    this.checkAllAnswered();
                } else {
                    resultElement.textContent = `‚ùå Incorrect. The correct answer is $${correctAnswer.toFixed(2)}${unit}`;
                    resultElement.className = 'result incorrect';
                }
            }
            
            checkAllAnswered() {
                const results = document.querySelectorAll('.result.correct');
                if (results.length === 7) {
                    this.showInterpretation();
                }
            }
            
            showInterpretation() {
                const market = this.currentMarket;
                const interpretation = document.getElementById('economic-interpretation');
                
                const consumerShare = (market.consumerBurden / market.taxRate) * 100;
                const producerShare = (market.producerBurden / market.taxRate) * 100;
                
                let analysis = `üìä <strong>Tax Incidence Analysis:</strong> In this ${market.type} market for ${market.good}, 
                the $${market.taxRate} tax is split with consumers bearing ${consumerShare.toFixed(1)}% (${market.consumerBurden.toFixed(2)}) 
                and producers bearing ${producerShare.toFixed(1)}% (${market.producerBurden.toFixed(2)}) of the burden. `;
                
                if (market.type === 'luxury') {
                    analysis += `Since demand is elastic (price-sensitive), consumers can reduce purchases, so producers absorb more of the tax burden.`;
                } else if (market.type === 'essential') {
                    analysis += `Since demand is inelastic (necessity goods), consumers have little choice but to pay higher prices, bearing most of the tax burden.`;
                } else {
                    analysis += `In this competitive market with elastic supply, the tax burden is shared relatively evenly between consumers and producers.`;
                }
                
                analysis += ` The government collects $${market.totalTaxRevenue.toFixed(2)} in total tax revenue.`;
                
                interpretation.innerHTML = analysis;
                interpretation.classList.remove('hidden');
            }
        }
        
        const simulator = new TaxIncidenceSimulator();
        
        function selectMarket(type) {
            simulator.currentMarketType = type;
            
            // Update button styling
            document.querySelectorAll('.market-btn').forEach(btn => {
                btn.style.opacity = '0.6';
            });
            event.target.style.opacity = '1';
        }
        
        function generateNewMarket() {
            simulator.currentMarket = simulator.generateMarket(simulator.currentMarketType);
            simulator.displayMarket(simulator.currentMarket);
        }
        
        function checkAnswer(type) {
            simulator.checkAnswer(type);
        }
        
        // Initialize with luxury market selected
        selectMarket('luxury');
    </script>
</body>
</html>
